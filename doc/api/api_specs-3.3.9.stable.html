<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><HTML><HEAD><TITLE>Kadeploy 3.3.9.stable REST API specifications</TITLE><LINK rel="stylesheet" type="text/css" href="api.css"></HEAD><BODY><DIV class="apidoc_frame"><H1 class="apidoc_title"><A class="apidoc_title_link" id="title">Kadeploy 3.3.9.stable REST API specifications</A></H1><DIV class="apidoc_index_frame"><UL class="apidoc_index_list"><LI><A class="apidoc_index_link" href="#intro">Introduction</A></LI><UL class="operation_index_list"><LI><A class="intro_index_link" href="#request_parameters">Request's parameters</A></LI><LI><A class="intro_index_link" href="#output_type">Output type and encoding</A></LI><LI><A class="intro_index_link" href="#Global parameters">Global parameters</A></LI><LI><A class="intro_index_link" href="#Authentication">Authentication</A></LI><LI><A class="intro_index_link" href="#Errors management">Errors management</A></LI><LI><A class="intro_index_link" href="#workflow_operations">Workflow based operations</A></LI><LI><A class="intro_index_link" href="#file_export">Exporting files for the server</A></LI><LI><A class="intro_index_link" href="#API documentation notations">API documentation notations</A></LI></UL><LI><A class="apidoc_index_link" href="#Workflow-based operations">Workflow-based operations</A></LI><UL class="operation_index_list"><LI><A class="operation_index_link" href="#POST/%OPERATION"><SPAN class="resource_id_method_POST">POST</SPAN> <SPAN class="resource_id_path">/%OPERATION</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/%OPERATION"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/%OPERATION</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/%OPERATION/:id"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/%OPERATION/:id</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/%OPERATION/:id/logs/:cluster?"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/%OPERATION/:id/logs/:cluster?</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/%OPERATION/:id/debugs/:node?"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/%OPERATION/:id/debugs/:node?</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/%OPERATION/:id/state"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/%OPERATION/:id/state</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/%OPERATION/:id/status"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/%OPERATION/:id/status</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/%OPERATION/:id/error"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/%OPERATION/:id/error</SPAN></A></LI><LI><A class="operation_index_link" href="#DELETE/%OPERATION/:id"><SPAN class="resource_id_method_DELETE">DELETE</SPAN> <SPAN class="resource_id_path">/%OPERATION/:id</SPAN></A></LI></UL><LI><A class="apidoc_index_link" href="#Reboot operations">Reboot operations</A></LI><UL class="operation_index_list"><LI><A class="operation_index_link" href="#POST/reboot"><SPAN class="resource_id_method_POST">POST</SPAN> <SPAN class="resource_id_path">/reboot</SPAN></A></LI></UL><LI><A class="apidoc_index_link" href="#Rights management">Rights management</A></LI><UL class="operation_index_list"><LI><A class="operation_index_link" href="#POST/rights"><SPAN class="resource_id_method_POST">POST</SPAN> <SPAN class="resource_id_path">/rights</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/rights/:username?/:node?"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/rights/:username?/:node?</SPAN></A></LI><LI><A class="operation_index_link" href="#PUT/rights/:username?/:node?"><SPAN class="resource_id_method_PUT">PUT</SPAN> <SPAN class="resource_id_path">/rights/:username?/:node?</SPAN></A></LI><LI><A class="operation_index_link" href="#DELETE/rights/:username/:node?/:partition?"><SPAN class="resource_id_method_DELETE">DELETE</SPAN> <SPAN class="resource_id_path">/rights/:username/:node?/:partition?</SPAN></A></LI></UL><LI><A class="apidoc_index_link" href="#Statistics">Statistics</A></LI><UL class="operation_index_list"><LI><A class="operation_index_link" href="#GET/stats/%OPERATION?"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/stats/%OPERATION?</SPAN></A></LI></UL><LI><A class="apidoc_index_link" href="#Nodes information">Nodes information</A></LI><UL class="operation_index_list"><LI><A class="operation_index_link" href="#GET/nodes/:nodename?"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/nodes/:nodename?</SPAN></A></LI></UL><LI><A class="apidoc_index_link" href="#Environments management">Environments management</A></LI><UL class="operation_index_list"><LI><A class="operation_index_link" href="#POST/environments"><SPAN class="resource_id_method_POST">POST</SPAN> <SPAN class="resource_id_path">/environments</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/environments?username=:username?&amp;amp;name=:name?&amp;amp;version=:version?"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/environments?username=:username?&name=:name?&version=:version?</SPAN></A></LI><LI><A class="operation_index_link" href="#PUT/environments/:username/:name/:version?"><SPAN class="resource_id_method_PUT">PUT</SPAN> <SPAN class="resource_id_path">/environments/:username/:name/:version?</SPAN></A></LI><LI><A class="operation_index_link" href="#PUT/environments/:username?/:name?/:version?"><SPAN class="resource_id_method_PUT">PUT</SPAN> <SPAN class="resource_id_path">/environments/:username?/:name?/:version?</SPAN></A></LI><LI><A class="operation_index_link" href="#DELETE/environments/:username/:name/:version?"><SPAN class="resource_id_method_DELETE">DELETE</SPAN> <SPAN class="resource_id_path">/environments/:username/:name/:version?</SPAN></A></LI></UL><LI><A class="apidoc_index_link" href="#Global information">Global information</A></LI><UL class="operation_index_list"><LI><A class="operation_index_link" href="#GET/clusters"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/clusters</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/auth_headers_prefix"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/auth_headers_prefix</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/info"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/info</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/version"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/version</SPAN></A></LI></UL><LI><A class="apidoc_index_link" href="#Deployment">Deployment</A></LI><UL class="operation_index_list"><LI><A class="operation_index_link" href="#POST/deployment"><SPAN class="resource_id_method_POST">POST</SPAN> <SPAN class="resource_id_path">/deployment</SPAN></A></LI></UL><LI><A class="apidoc_index_link" href="#Console">Console</A></LI><UL class="operation_index_list"><LI><A class="operation_index_link" href="#POST/console"><SPAN class="resource_id_method_POST">POST</SPAN> <SPAN class="resource_id_path">/console</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/console"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/console</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/console/:id"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/console/:id</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/console/:id/error"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/console/:id/error</SPAN></A></LI><LI><A class="operation_index_link" href="#DELETE/console/:id"><SPAN class="resource_id_method_DELETE">DELETE</SPAN> <SPAN class="resource_id_path">/console/:id</SPAN></A></LI></UL><LI><A class="apidoc_index_link" href="#Power operations">Power operations</A></LI><UL class="operation_index_list"><LI><A class="operation_index_link" href="#PUT/power"><SPAN class="resource_id_method_PUT">PUT</SPAN> <SPAN class="resource_id_path">/power</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/power"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/power</SPAN></A></LI></UL></UL></DIV><HR class="apidoc_index_sep"><DIV class="intro_frame"><H1 class="intro_title"><A class="intro_title_link" id="intro">Introduction</A></H1><DIV class="section_frame"><H2 class="section_title"><A id="request_parameters">Request's parameters</A></H2><P class="section_paragraph">There is several ways to specify parameters when using the network API. Parameters can be specified in the query's URI parameter but also in the query's body. Remark: it's only possible to use String and Array data structures when specifying parameters using the query's URI to specify more advanced parameters (Numbers, Hashs, ...) it's necessary to specify the parameters using a more advanced description language (JSON/YAML) in the query's body.</P><P class="section_paragraph">The following examples are equivalent:</P><P class="section_paragraph"><B>Specifying parameters in the query's URI</B></P><P class="section_paragraph"><PRE class="code_sample">      POST /deploy?nodes=node-1.testbed.lan&nodes=node-2.testbed.lan HTTP/1.1
      Accept: */*
      Host: kadeploy.testbed.lan:25300
      X-Kadeploy-User: frontend
</PRE></P><P class="section_paragraph"><B>Specifying parameters in the query's body</B></P><P class="section_paragraph"><TT>JSON body</TT></P><P class="section_paragraph"><PRE class="code_sample">      POST /deploy HTTP/1.1
      Accept: */*
      Host: kadeploy.testbed.lan:25300
      X-Kadeploy-User: frontend
      Content-Type: application/json
      Content-Length: 73
      {
        "nodes": [
          "node-1.testbed.lan",
          "node-2.testbed.lan"
        ]
      }
</PRE></P><P class="section_paragraph"><TT>YAML body</TT></P><P class="section_paragraph"><PRE class="code_sample">      POST /deploy HTTP/1.1
      Accept: */*
      Host: kadeploy.testbed.lan:25300
      X-Kadeploy-User: frontend
      Content-Type: application/x-yaml
      Content-Length: 47
      ---
      nodes:
      - node-1.testbed.lan
      - node-2.testbed.lan
</PRE></P><P class="operation_back_link"><A class="operation_back_link" href="#title">Back to title</A></P></DIV><DIV class="section_frame"><H2 class="section_title"><A id="output_type">Output type and encoding</A></H2><P class="section_paragraph">The Kadeploy server can respond to a request in different formats: JSON and YAML, with or without compression (gzip only).</P><P class="section_paragraph">The response format depends on the value of the 'Accept' HTTP header of the request. By default (if it's set to */*) the response will be formated in JSON otherwise it will use the specified format.</P><P class="section_paragraph">The response encoding (compression) depends on the value of the 'Accept-Encoding' HTTP header. By default (if it's not set or set to */*) the response will not be compressed, otherwise it will be compressed using the gzip algorithm.</P><P class="section_paragraph">Here are some examples:</P><P class="section_paragraph"><B>JSON response</B></P><P class="section_paragraph"><PRE class="code_sample">      GET /nodes HTTP/1.1
      Accept: application/json
      Host: kadeploy.testbed.lan:25300
      X-Kadeploy-User: frontend
</PRE></P><P class="section_paragraph"><PRE class="code_sample">      HTTP/1.1 200 OK
      Content-Type: application/json
      Content-Length: 50
      [
        "node-1.testbed.lan",
        "node-2.testbed.lan"
      ]
</PRE></P><P class="section_paragraph"><B>YAML response</B></P><P class="section_paragraph"><PRE class="code_sample">      GET /nodes HTTP/1.1
      Accept: application/x-yaml
      Host: kadeploy.testbed.lan:25300
      X-Kadeploy-User: frontend
</PRE></P><P class="section_paragraph"><PRE class="code_sample">      HTTP/1.1 200 OK
      Content-Type: application/x-yaml
      Content-Length: 47
      ---
      - node-1.testbed.lan
      - node-2.testbed.lan
</PRE></P><P class="section_paragraph"><B>Compressed JSON response</B></P><P class="section_paragraph"><PRE class="code_sample">      GET /nodes HTTP/1.1
      Accept: application/x-yaml
      Accept-Encoding: gzip
      Host: kadeploy.testbed.lan:25300
      X-Kadeploy-User: frontend
</PRE></P><P class="section_paragraph"><PRE class="code_sample">      HTTP/1.1 200 OK
      Content-Type: application/json
      Content-Encoding: gzip
      Content-Length: 52
      ...BINARY_DATA...
</PRE></P><P class="operation_back_link"><A class="operation_back_link" href="#title">Back to title</A></P></DIV><DIV class="section_frame"><H2 class="section_title"><A id="Global parameters">Global parameters</A></H2><P class="section_paragraph">Some parameters are mendatory, they have to be precised in each request as parameter. Here is a list of them: <I>user</I>.</P><P class="operation_back_link"><A class="operation_back_link" href="#title">Back to title</A></P></DIV><DIV class="section_frame"><H2 class="section_title"><A id="Authentication">Authentication</A></H2><P class="section_paragraph">To access API resources an authentication is needed. There is four different methods to authenticate when accessing a ressource. Depending on the server's configuration it will be possible to use -at least- one of this methods.</P><P class="section_paragraph">Authentication parameters are given in the HTTP headers of the request. A prefix can be set to this parameters, this prefix default to 'X-Kadeploy' but it can be set to another value (see <A href="#GET/auth_headers_prefix">GET /auth_headers_prefix</A>).</P><P class="section_paragraph"><B>Authentication using the IDENT protocol</B></P><P class="section_paragraph">The first authentication method is based on the IDENT protocol. When a request will be received on the server, it will first check if the request is coming from a trusted machine then it will contact the IDENT server of this machine in order to be sure that the username specified in the 'User' request's header is actually corresponding to the user on the machine that initiated the request. The 'User' request's header is not mandatory. In order to be authenticated with this method, no extra parameters have to be providen, an IDENT server just have to be set up on the machine that is used to initiate the request. Here is an example:</P><P class="section_paragraph"><PRE class="code_sample">      GET /nodes HTTP/1.1
      Accept: */*
      Host: kadeploy.testbed.lan:25300
      X-Kadeploy-User: frontend
</PRE></P><P class="section_paragraph"><B>Authentication by password</B></P><P class="section_paragraph">The second authentication method is the authentication by password (from trusted machines) using the HTTP Basic Authentication method (RFC 2617). In order to authenticate with such a method it's necessary to specify the user and password as a base64 string in the 'Authorization' request's header. Here is some examples:</P><P class="section_paragraph"><PRE class="code_sample">      GET /nodes HTTP/1.1
      Accept: */*
      Host: kadeploy.testbed.lan:25300
      Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ==
</PRE></P><P class="section_paragraph"><B>Authentication by certificate</B></P><P class="section_paragraph">To be able to authenticate using a (x509) certificate it's necessary to provide a base64 encoded x509 certificate that was signed with the trusted CA private key in the 'Certificate' request's header. The username must appear in the certificate's subject CN field. The 'User' request's header is not mandatory. Here is an example:</P><P class="section_paragraph"><PRE class="code_sample">      GET /nodes HTTP/1.1
      Accept: */*
      Host: kadeploy.testbed.lan:25300
      X-Kadeploy-User: frontend
      X-Kadeploy-Certificate: MIIEIzCCAwugAwIBAgIBGTANBgkqhkiG9w0BAQUFADBiMQswCQYDVQQ...XnMuLyV1FQ==
</PRE></P><P class="section_paragraph"><B>Authentication by ACL</B></P><P class="section_paragraph">If your machine's hostname is in the server's Access Control List, it will be trust without any further verifications. Here is an example:</P><P class="section_paragraph"><PRE class="code_sample">      GET /nodes HTTP/1.1
      Accept: */*
      Host: kadeploy.testbed.lan:25300
      X-Kadeploy-User: frontend
</PRE></P><P class="operation_back_link"><A class="operation_back_link" href="#title">Back to title</A></P></DIV><DIV class="section_frame"><H2 class="section_title"><A id="Errors management">Errors management</A></H2><P class="section_paragraph">Two kind of errors will be returned by the service: classical HTTP errors (Unauthorized, Forbidden, Not Found, ...) and Kadeploy specific errors.</P><P class="section_paragraph">Classical HTTP errors will be return fitting with the HTTP 1.1 standards, an error message will be add in the body of the response.</P><P class="section_paragraph">Kadeploy errors will be returned using the HTTP return code 400 (Bad Request) plus some (non-standard) HTTP header: X-Application-Error-Code and X-Application-Error-Info. The header X-Application-Error-Code will contain a Kadeploy specific error code while the header X-Application-Error-Info contains a (Base64 encoded) error message. The Kadeploy specific error codes are described in the following.</P><P class="section_paragraph">Here is an example of a Kadeploy specific error response:</P><P class="section_paragraph"><PRE class="code_sample">      HTTP/1.1 400 Bad Request
      X-Application-Error-Code: 6
      X-Application-Error-Info: WW91IGRvIG5vdCBoYXZlIHN1ZmZpY2llbnQgcmlnaHRzIHRvIHBlcmZvcm0gdGhlIG9wZXJhdGlvbiBvbiBhbGwgdGhlIG5vZGVz
      Content-Type: text/plain
      Content-Length: 75
      You do not have sufficient rights to perform the operation on all the nodes
</PRE></P><P class="section_paragraph"><B>Kadeploy error codes</B></P><P class="section_paragraph"><TABLE style="margin-left: 40px;"><TR><TH>Error #</TH><TH>Name</TH><TH>Description</TH></TR><TR><TD>1</TD><TD>INVALID_WORKFLOW_ID</TD><TD>Invalid workflow ID</TD></TR><TR><TD>2</TD><TD>INVALID_NODELIST</TD><TD>Invalid node list</TD></TR><TR><TD>3</TD><TD>INVALID_CLIENT</TD><TD>Invalid client's export</TD></TR><TR><TD>4</TD><TD>INVALID_OPTION</TD><TD>Invalid option in the request</TD></TR><TR><TD>5</TD><TD>INVALID_FILE</TD><TD>Invalid file</TD></TR><TR><TD>6</TD><TD>INVALID_RIGHTS</TD><TD>You do not have sufficient rights to perform the operation on all the nodes</TD></TR><TR><TD>7</TD><TD>INVALID_ENVIRONMENT</TD><TD>Invalid environment specification</TD></TR><TR><TD>8</TD><TD>INVALID_CUSTOMOP</TD><TD>Invalid custom operations specification</TD></TR><TR><TD>9</TD><TD>INVALID_VLAN</TD><TD>Invalid VLAN</TD></TR><TR><TD>10</TD><TD>EXISTING_ELEMENT</TD><TD>Element already exists</TD></TR><TR><TD>11</TD><TD>CONFLICTING_ELEMENTS</TD><TD>Some elements already exists and are conflicting</TD></TR><TR><TD>12</TD><TD>MISSING_OPTION</TD><TD>Some options are missing</TD></TR><TR><TD>13</TD><TD>CONFLICTING_OPTIONS</TD><TD>Some options are conflicting</TD></TR><TR><TD>14</TD><TD>NOTHING_MODIFIED</TD><TD>No element has been modified</TD></TR><TR><TD>15</TD><TD>EXECUTE_ERROR</TD><TD>The execution of a command failed</TD></TR><TR><TD>20</TD><TD>DATABASE_ERROR</TD><TD>Database issue</TD></TR><TR><TD>21</TD><TD>CACHE_ERROR</TD><TD>Something went wront with the cache system</TD></TR><TR><TD>22</TD><TD>CACHE_FULL</TD><TD>The cache is full</TD></TR><TR><TD>30</TD><TD>DESTRUCTIVE_ENVIRONMENT</TD><TD>Cannot reboot since the last deployed environment was destructive</TD></TR></TABLE></P><P class="operation_back_link"><A class="operation_back_link" href="#title">Back to title</A></P></DIV><DIV class="section_frame"><H2 class="section_title"><A id="workflow_operations">Workflow based operations</A></H2><P class="section_paragraph">Since some operations take time to be executed and can't directly return a result, we implemented a common asynchronious workflow.</P><P class="section_paragraph">The idea here will be to:</P><P class="section_paragraph"><UL><LI>(1) Initialize the operation (see <A href="#POST/%OPERATION">POST /%OPERATION</A>);</LI><LI>(2) Do some polling to know if the operation is done (see <A href="#GET/%OPERATION/:id">GET /%OPERATION/:id</A>);</LI><LI>(3) Gather operation's logs when soma are marked as available (see <A href="#GET/%OPERATION/:id/logs/:cluster?">GET /%OPERATION/:id/logs/:cluster?</A>);</LI><LI>(4) When the operation is marked as done, delete workflow informations from the server (see <A href="#DELETE/%OPERATION/:id">DELETE /%OPERATION/:id</A>);</LI><LI>(!!) If the error state is set at true during the process, gather the error message and delete workflow information (see <A href="#GET/%OPERATION/:id/error">GET /%OPERATION/:id/error</A>);</LI></UL></P><P class="section_paragraph"><A href="#Deployment">Deployment</A>, <A href="#Reboot operations">Reboot</A> and <A href="#Power operations">Power</A> operations are workflow-based. For more information please take a look at the section <A href="#Workflow-based operations">Workflow-based operations</A>.</P><P class="operation_back_link"><A class="operation_back_link" href="#title">Back to title</A></P></DIV><DIV class="section_frame"><H2 class="section_title"><A id="file_export">Exporting files for the server</A></H2><P class="section_paragraph">Files can be specified to the server using different methods. To change the method, you have to use specific protocols in the URI of the file.</P><P class="section_paragraph">Here are the supported protocols:</P><P class="section_paragraph"><B>http://</B></P><P class="section_paragraph">The file is hosted at the following HTTP url</P><P class="section_paragraph"><B>local://</B> or <B>nothing</B></P><P class="section_paragraph">The file is hosted on a dynamic location, the parameter <TT>client</TT> will be used to specify where is the file hosted.</P><P class="section_paragraph">The server will try to download the file at <TT>[client]/Base64(filename)</TT>.</P><P class="section_paragraph">For sample, if the specified file is <TT>file:///home/frontend/file</TT> and <TT>client</TT> is set to <TT>http://frontend.testbed.lan:12345</TT>, the server will try to download the file <TT>http://frontend.testbed.lan:12345/L2hvbWUvZnJvbnRlbmQvZmlsZQo=</TT>.</P><P class="section_paragraph"><B>server://</B></P><P class="section_paragraph">The file is hosted on the Kadeploy server</P><P class="section_paragraph">Samples:</P><P class="section_paragraph"><B>HTTP hosted file</B></P><P class="section_paragraph"><PRE class="code_sample">      POST /environments HTTP/1.1
      Accept: text/plain, application/json
      Host: kadeploy.testbed.lan:25300
      X-Kadeploy-User: frontend
      Content-Type: application/json
      Content-Length: 301
      {
        "environment": {
          "name": "debian-base",
          ...
          "image": {
            "file": "http://testbed.lan/debian-base.tgz",
            "kind": "tar",
            "compression": "gzip"
          },
          ...
        }
      }
</PRE></P><P class="section_paragraph"><B>Localy hosted files</B></P><P class="section_paragraph"><PRE class="code_sample">      POST /environments HTTP/1.1
      Accept: text/plain, application/json
      Host: kadeploy.testbed.lan:25300
      X-Kadeploy-User: frontend
      Content-Type: application/json
      Content-Length: 731
      {
        "client": "http://frontend.testbed.lan:12345",
        "environment": {
          "name": "debian-base",
          ...
          "image": {
            "file": "/home/frontend/debian-base.tgz",
            "kind": "tar",
            "compression": "gzip"
          },
          "postinstalls": [
            {
              "archive": "/home/frontend/debian-base-postinstall.tgz",
              "compression": "gzip",
              "script": "traitement.ash /rambin"
            }
          ],
          ...
        }
      }
</PRE></P><P class="section_paragraph"><B>Server hosted files</B></P><P class="section_paragraph"><PRE class="code_sample">      POST /environments HTTP/1.1
      Accept: text/plain, application/json
      Host: kadeploy.testbed.lan:25300
      X-Kadeploy-User: frontend
      Content-Type: application/json
      Content-Length: 657
      {
        "environment": {
          "name": "debian-base",
          ...
          "image": {
            "file": "server:///tmp/debian-base.fsa",
            "kind": "fsa",
            "compression": 3
          },
          ...
        }
      }
</PRE></P><P class="operation_back_link"><A class="operation_back_link" href="#title">Back to title</A></P></DIV><DIV class="section_frame"><H2 class="section_title"><A id="API documentation notations">API documentation notations</A></H2><P class="section_paragraph">When using the Network API, the data structures used to describe resources can be complex (Array, Hash, nested structured, ...), that's why we decided to use a specific formalism to describe them.</P><P class="section_paragraph"><B>Body's type of the request/response</B></P><P class="section_paragraph">First of all, the type of the main structure is describe in the title, for sample:</P><P class="section_paragraph"><H3 class="request_title" style="margin-left: 50px;">Request/Response/Type<SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>)</SPAN></H3></P><P class="section_paragraph">Means that the request's body have to be a Hash, formated used one of the allowed Content-Type (see <A href="#request_parameters">Request's parameters</A> and <A href="#output_type">Output type and encoding</A>)</P><P class="section_paragraph"><B>Hash</B></P><P class="section_paragraph">Here is an example of the description of a simple Hash and some basic elements, the <TT>{}</TT> chars are used to specify that "myhash" has the type Hash.</P><P class="section_paragraph"><DIV style="margin-left: 50px"><DIV class="type_frame"><H3 class="type_title"><A id="type_Example"><B class="type_name">Example</B><SPAN class="type_title_desc">(<SPAN class="type_basetype">Hash</SPAN>)</SPAN></A></H3><P class="type_desc">An example</P><DIV class="type_subframe"><TABLE class="type_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name">{<SPAN class="element_self"><SPAN class="element_normal">myhash</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The sample Hash</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">myhash</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">user</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The username</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">myhash</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">size</SPAN></SPAN></TD><TD class="field_type">Integer</TD><TD class="field_desc">The size</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">myhash</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">option</SPAN></SPAN></TD><TD class="field_type">Boolean</TD><TD class="field_desc">Enable/Disable "option"</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">myhash</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">setting</SPAN></SPAN></TD><TD class="field_type">Set</TD><TD class="field_desc">If this field is set, no mather it's value, the option "setting" is enabled</TD></TR></TABLE></DIV></DIV></DIV></P><P class="section_paragraph">An HTTP request's sample:</P><P class="section_paragraph"><DIV style="margin-left: 50px"><PRE class="code_sample">      POST /sample HTTP/1.1
      Accept: text/plain, application/json
      Content-Type: application/json
      Content-Length: 81
      {
        "myhash": {
          "size": 42,
          "option": true,
          "setting": null
        }
      }
</PRE></DIV></P><P class="section_paragraph"><B>Arrays</B></P><P class="section_paragraph">Here is an example of the description of a simple Array, the <TT>[]</TT> chars are used to specify that "myarray" has the type Array, the char <TT>#</TT> specify that the element that is described is the result of an iteration on the Array.</P><P class="section_paragraph"><DIV style="margin-left: 50px"><DIV class="type_frame"><H3 class="type_title"><A id="type_Example"><B class="type_name">Example</B><SPAN class="type_title_desc">(<SPAN class="type_basetype">Hash</SPAN>)</SPAN></A></H3><P class="type_desc">An example</P><DIV class="type_subframe"><TABLE class="type_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name">[<SPAN class="element_self"><SPAN class="element_normal">myarray</SPAN></SPAN>]</TD><TD class="field_type">Array</TD><TD class="field_desc">The sample Array</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">[<SPAN class="element_normal">myarray</SPAN>]</SPAN>.<SPAN class="element_self"><SPAN class="element_iter">#i</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The element #i</TD></TR></TABLE></DIV></DIV></DIV></P><P class="section_paragraph">An HTTP request's sample:</P><P class="section_paragraph"><DIV style="margin-left: 50px"><PRE class="code_sample">      POST /sample HTTP/1.1
      Accept: text/plain, application/json
      Content-Type: application/json
      Content-Length: 54
      {
        "myarray": [
          "abc",
          "def",
          "ghi"
        ]
      }
</PRE></DIV></P><P class="section_paragraph"><B>Dynamic Hash key names</B></P><P class="section_paragraph">Hash table's keys do not always have a static name, in some cases, the key name can be dynamic. In this case, the key name will be <SPAN class="element_dynamic">underlined</SPAN> this way. Here is an example:</P><P class="section_paragraph"><DIV style="margin-left: 50px"><DIV class="type_frame"><H3 class="type_title"><A id="type_Example"><B class="type_name">Example</B><SPAN class="type_title_desc">(<SPAN class="type_basetype">Hash</SPAN>)</SPAN></A></H3><P class="type_desc">An example</P><DIV class="type_subframe"><TABLE class="type_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name">{<SPAN class="element_self"><SPAN class="element_normal">myhash</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The sample Hash</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">myhash</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_dynamic">nodename</SPAN></SPAN></TD><TD class="field_type">Integer</TD><TD class="field_desc">Returns the uptime of the node "nodename"</TD></TR></TABLE></DIV></DIV></DIV></P><P class="section_paragraph">An HTTP request's sample:</P><P class="section_paragraph"><DIV style="margin-left: 50px"><PRE class="code_sample">      POST /sample HTTP/1.1
      Accept: text/plain, application/json
      Content-Type: application/json
      Content-Length: 83
      {
        "myhash": {
          "node-1": 12345,
          "node-2": 45678,
          "node-3": 90123
        }
      }
</PRE></DIV></P><P class="section_paragraph"><B>URI path parameters</B></P><P class="section_paragraph">Some parameters can be specified in the URI, in the documentation, this parameters will be <SPAN class="element_param">underlined</SPAN>.</P><P class="section_paragraph">In the URI, dynamic parameters will be prefixed with a <TT>:</TT> such as <TT>:name</TT>; if the parameter is suffixed with a <TT>?</TT>, this parameter is optional, for sample <TT>:version?</TT>. Here is an example :</P><P class="section_paragraph"><SPAN class="resource_path"></SPAN></P><P class="section_paragraph"><DIV style="margin-left: 50px"><DIV class="type_frame"><H3 class="type_title"><A id="type_GET /sample/:name/:version?"><B class="type_name">GET /sample/:name/:version?</B><SPAN class="type_title_desc">(<SPAN class="type_basetype"> </SPAN>)</SPAN></A></H3><P class="type_desc">An example</P><DIV class="type_subframe"><TABLE class="type_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">user</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The user</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_param">name</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The name</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_param">version</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The version</TD></TR></TABLE></DIV></DIV></DIV></P><P class="section_paragraph">An HTTP request's sample:</P><P class="section_paragraph"><DIV style="margin-left: 50px"><PRE class="code_sample">      GET /sample/thename/ HTTP/1.1
      Accept: text/plain, application/json
</PRE></DIV></P><P class="section_paragraph"><B>Nested structured</B></P><P class="section_paragraph">Structures can then be nested in different ways:</P><P class="section_paragraph"><DIV style="margin-left: 50px"><DIV class="type_frame"><H3 class="type_title"><A id="type_Example"><B class="type_name">Example</B><SPAN class="type_title_desc">(<SPAN class="type_basetype">Hash</SPAN>)</SPAN></A></H3><P class="type_desc">An example</P><DIV class="type_subframe"><TABLE class="type_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name">{<SPAN class="element_self"><SPAN class="element_normal">myhash</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The sample Hash</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_param">version</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The version</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">myhash</SPAN>}</SPAN>.{<SPAN class="element_self"><SPAN class="element_normal">anotherhash</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The first hash</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">myhash</SPAN>}</SPAN>.{<SPAN class="element_normal">anotherhash</SPAN>}</SPAN>.{<SPAN class="element_self"><SPAN class="element_dynamic">nodename</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">Description of the node "nodename"</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">myhash</SPAN>}</SPAN>.{<SPAN class="element_normal">anotherhash</SPAN>}</SPAN>.{<SPAN class="element_dynamic">nodename</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">user</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The username</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">myhash</SPAN>}</SPAN>.{<SPAN class="element_normal">anotherhash</SPAN>}</SPAN>.{<SPAN class="element_dynamic">nodename</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">option</SPAN></SPAN></TD><TD class="field_type">Boolean</TD><TD class="field_desc">Enable/Disable "option"</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">myhash</SPAN>}</SPAN>.[<SPAN class="element_self"><SPAN class="element_normal">myarray</SPAN></SPAN>]</TD><TD class="field_type">Array</TD><TD class="field_desc">The first array</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">myhash</SPAN>}</SPAN>.[<SPAN class="element_normal">myarray</SPAN>]</SPAN>.{<SPAN class="element_self"><SPAN class="element_iter">#i</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The element #i</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">myhash</SPAN>}</SPAN>.[<SPAN class="element_normal">myarray</SPAN>]</SPAN>.{<SPAN class="element_iter">#i</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">size</SPAN></SPAN></TD><TD class="field_type">Integer</TD><TD class="field_desc">The size</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">myhash</SPAN>}</SPAN>.[<SPAN class="element_normal">myarray</SPAN>]</SPAN>.{<SPAN class="element_iter">#i</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">setting</SPAN></SPAN></TD><TD class="field_type">Set</TD><TD class="field_desc">If this field is set, no mather it's value, the option "setting" is enabled</TD></TR></TABLE></DIV></DIV></DIV></P><P class="section_paragraph">An HTTP request's sample:</P><P class="section_paragraph"><DIV style="margin-left: 50px"><PRE class="code_sample">      POST /sample HTTP/1.1
      Accept: text/plain, application/json
      Content-Type: application/json
      Content-Length: 351
      {
        "myhash": {
          "anotherhash": {
            "node-1": {
              "user": "user1",
              "option": true
            },
            "node-2": {
              "user": "user2",
              "option": false
            }
          },
          "myarray": [
            {
              "size": 4,
              "setting": null
            },
            {
              "size": 2
            },
            {
              "size": 8
            }
          ]
        }
      }
</PRE></DIV></P><P class="operation_back_link"><A class="operation_back_link" href="#title">Back to title</A></P></DIV></DIV><HR class="operation_sep"><DIV class="operation_frame"><H1 class="operation_title"><A id="Workflow-based operations">Workflow-based operations</A></H1><DIV class="operation_index_frame"><H2 class="operation_index_title">Resources</H2><UL class="operation_index_list"><LI><A class="operation_index_link" href="#POST/%OPERATION"><SPAN class="resource_id_method_POST">POST</SPAN> <SPAN class="resource_id_path">/%OPERATION</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/%OPERATION"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/%OPERATION</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/%OPERATION/:id"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/%OPERATION/:id</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/%OPERATION/:id/logs/:cluster?"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/%OPERATION/:id/logs/:cluster?</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/%OPERATION/:id/debugs/:node?"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/%OPERATION/:id/debugs/:node?</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/%OPERATION/:id/state"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/%OPERATION/:id/state</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/%OPERATION/:id/status"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/%OPERATION/:id/status</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/%OPERATION/:id/error"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/%OPERATION/:id/error</SPAN></A></LI><LI><A class="operation_index_link" href="#DELETE/%OPERATION/:id"><SPAN class="resource_id_method_DELETE">DELETE</SPAN> <SPAN class="resource_id_path">/%OPERATION/:id</SPAN></A></LI></UL><H2 class="operation_index_title">Return types</H2><DIV class="type_frame"><H3 class="type_title"><A id="type_Workflow"><B class="type_name">Workflow</B><SPAN class="type_title_desc">(<SPAN class="type_basetype">Hash</SPAN>)</SPAN></A></H3><P class="type_desc">The information related to the workflow of an operation (deployment,reboot,power)</P><DIV class="type_subframe"><TABLE class="type_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">id</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The id# of the operation (prefixed by "D-" for deployment, "R-" for reboot, "P-" for power and "C-" for console)</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">user</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The user that initiated the operation</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">done</SPAN></SPAN></TD><TD class="field_type">Boolean</TD><TD class="field_desc">Set to true if the operation is done. Once an operation is done it's information should be removed from the API using the DELETE method.</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">error</SPAN></SPAN></TD><TD class="field_type">Boolean</TD><TD class="field_desc">Set to true if an error was encountered. The error message can be obtained by getting /%OPERATION/:id/error.</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">start_time</SPAN></SPAN></TD><TD class="field_type">Integer</TD><TD class="field_desc">The start time (POSIX time) of the operation</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">logs</SPAN></SPAN></TD><TD class="field_type">Boolean</TD><TD class="field_desc">New logs available for polling (see /%OPERATION/:id/logs). Only available to the users that have the rights to consult the information about this operation.</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">debugs</SPAN></SPAN></TD><TD class="field_type">Boolean</TD><TD class="field_desc">New debugs available for polling (see /%OPERATION/:id/debugs). Only available to the users that have the rights to consult the information about this operation.</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">time</SPAN></SPAN></TD><TD class="field_type">Float</TD><TD class="field_desc">The time elapsed since the start of the operation. Only available to the users that have the rights to consult the information about this operation.</TD></TR><TR class="field_frame"><TD class="field_name">{<SPAN class="element_self"><SPAN class="element_normal">environment</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The environment that is currently being deployed. Only displayed when the operation uses an environment. Only available to the users that have the rights to consult the information about this operation.</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">id</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The id# of the environment</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">user</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The owner of the environment</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">name</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The name of the environment</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">version</SPAN></SPAN></TD><TD class="field_type">Integer</TD><TD class="field_desc">The version of the environment</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">nodes</SPAN></SPAN></TD><TD class="field_type">Hash/Array</TD><TD class="field_desc">If the user have the rights to consult the information, a list of nodes ordered by state will be returned otherwise an Array of the nodes involved in the operation will be returned</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_normal">nodes</SPAN></SPAN>.[<SPAN class="element_self"><SPAN class="element_normal">ok</SPAN></SPAN>]</TD><TD class="field_type">Array</TD><TD class="field_desc">The list of nodes that have finish the operation successfully</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_normal">nodes</SPAN></SPAN>.[<SPAN class="element_self"><SPAN class="element_normal">ko</SPAN></SPAN>]</TD><TD class="field_type">Array</TD><TD class="field_desc">The list of nodes that have finish the operation with an error. The error message of each node can be obtained by getting /%OPERATION/:id/state.</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_normal">nodes</SPAN></SPAN>.[<SPAN class="element_self"><SPAN class="element_normal">processing</SPAN></SPAN>]</TD><TD class="field_type">Array</TD><TD class="field_desc">The list of nodes that are still processing the operation</TD></TR></TABLE></DIV><H3 class="type_subtitle">Example #1</H3><PRE class="code_sample">{
  "id": "D-b9401264-4383-4401-a548-1f881ea14acb",
  "user": "frontend",
  "done": false,
  "error": false,
  "environment": {
    "id": -1,
    "user": "frontend",
    "name": "debian-anon",
    "version": 1
  },
  "logs": false,
  "nodes": {
    "ok": [
    ],
    "ko": [
    ],
    "processing": [
      "node-2.testbed.lan"
    ]
  },
  "time": 30.92
},</PRE><H3 class="type_subtitle">Example #2</H3><PRE class="code_sample">{
  "id": "D-75105d91-777a-4e3b-bf4e-2690a544031a",
  "user": "root",
  "done": false,
  "error": false,
  "nodes": [
    "node-1.testbed.lan"
  ]
}</PRE><H3 class="type_subtitle">Example #3</H3><PRE class="code_sample">{
  "id": "R-4d657bda-1cad-4739-ab3d-e58879a3d962",
  "user": "frontend",
  "done": false,
  "error": false,
  "nodes": [
    "node-1.testbed.lan",
    "node-2.testbed.lan"
  ]
}</PRE><H3 class="type_subtitle">Example #4</H3><PRE class="code_sample">{
  "id": "P-bf447aae-1fd5-4062-b1ff-03e72d5de6ba",
  "user": "frontend",
  "done": false,
  "error": false,
  "logs": true,
  "nodes": {
    "ok": [
    ],
    "ko": [
    ],
    "processing": [
      "node-1.testbed.lan",
      "node-2.testbed.lan"
    ]
  },
  "time": 1.01
}</PRE></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#title">Back to title</A></P><HR class="operation_index_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="POST/%OPERATION"><B class="resource_method_POST">POST</B> <SPAN style="font-family: monospace;" class="resource_path">/%OPERATION</SPAN></A></H2><P class="resource_desc">Launch an operation</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">...</SPAN></SPAN></TD><TD class="parameter_type">Deployment/Reboot/Power</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The operation's parameters</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">breakpoint</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The name of a step to breakpoint on (can be MacrostepName or MacrostepName:MicrostepName)</TD></TR><TR class="parameter_frame"><TD class="parameter_name">{<SPAN class="element_self"><SPAN class="element_normal">custom_operations</SPAN></SPAN>}</TD><TD class="parameter_type">Hash</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Add some custom steps to the operation's workflow</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">debug</SPAN></SPAN></TD><TD class="parameter_type">Set</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Enable the command's debugging</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">force</SPAN></SPAN></TD><TD class="parameter_type">Set</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Force the operation, even if the nodes seems to be already involved in another one</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">hook</SPAN></SPAN></TD><TD class="parameter_type">Set</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Enable the server-side hook at the end of the operation</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">verbose_level</SPAN></SPAN></TD><TD class="parameter_type">Integer</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The verbose level of the logs<BR><EM>Expected values: </EM>1, 2, 3, 4, 5</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">custom_operations</SPAN>}</SPAN>.{<SPAN class="element_self"><SPAN class="element_dynamic">macrostepname</SPAN></SPAN>}</TD><TD class="parameter_type">Hash</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The macro-step the custom-step has to be added to</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">custom_operations</SPAN>}</SPAN>.{<SPAN class="element_dynamic">macrostepname</SPAN>}</SPAN>.{<SPAN class="element_self"><SPAN class="element_dynamic">microstepname</SPAN></SPAN>}</TD><TD class="parameter_type">Hash</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The micro-step the custom-step has to be added to</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">custom_operations</SPAN>}</SPAN>.{<SPAN class="element_dynamic">macrostepname</SPAN>}</SPAN>.{<SPAN class="element_dynamic">microstepname</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_dynamic">overwrite</SPAN></SPAN></TD><TD class="parameter_type">Boolean</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Overwrite the custom-steps that were add in the configuration by the administrators<BR><EM>Default value: </EM>false</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">custom_operations</SPAN>}</SPAN>.{<SPAN class="element_dynamic">macrostepname</SPAN>}</SPAN>.{<SPAN class="element_dynamic">microstepname</SPAN>}</SPAN>.[<SPAN class="element_self"><SPAN class="element_dynamic">where</SPAN></SPAN>]</TD><TD class="parameter_type">Array</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">A list of actions to be substitued/pre/post to this step<BR><EM>Expected values: </EM>substitute, pre-ops, post-ops</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">custom_operations</SPAN>}</SPAN>.{<SPAN class="element_dynamic">macrostepname</SPAN>}</SPAN>.{<SPAN class="element_dynamic">microstepname</SPAN>}</SPAN>.[<SPAN class="element_dynamic">where</SPAN>]</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">action</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The action that have to be performed<BR><EM>Expected values: </EM>run, send, exec</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">custom_operations</SPAN>}</SPAN>.{<SPAN class="element_dynamic">macrostepname</SPAN>}</SPAN>.{<SPAN class="element_dynamic">microstepname</SPAN>}</SPAN>.[<SPAN class="element_dynamic">where</SPAN>]</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">command</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">(To be specified if the action is "exec") The command to be executed. If you want to call a script, dont forget to add a "." (or use "source") before the script name to be able to use Kadeploy3 environment variables inside of it (example: "command: . /myscript.sh").</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">custom_operations</SPAN>}</SPAN>.{<SPAN class="element_dynamic">macrostepname</SPAN>}</SPAN>.{<SPAN class="element_dynamic">microstepname</SPAN>}</SPAN>.[<SPAN class="element_dynamic">where</SPAN>]</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">destination</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">(To be specified if the action is "send") The destination directory on the nodes (Kadeploy3 environment variables are substitued in the path)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">custom_operations</SPAN>}</SPAN>.{<SPAN class="element_dynamic">macrostepname</SPAN>}</SPAN>.{<SPAN class="element_dynamic">microstepname</SPAN>}</SPAN>.[<SPAN class="element_dynamic">where</SPAN>]</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">file</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">(To be specified if the action is "send" or "run") The path to the file to be send/executed (if the action is "send" the file name will remains the same, if the action is "run" this file need to contain a script)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">custom_operations</SPAN>}</SPAN>.{<SPAN class="element_dynamic">macrostepname</SPAN>}</SPAN>.{<SPAN class="element_dynamic">microstepname</SPAN>}</SPAN>.[<SPAN class="element_dynamic">where</SPAN>]</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">name</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The name of the custom operation</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">custom_operations</SPAN>}</SPAN>.{<SPAN class="element_dynamic">macrostepname</SPAN>}</SPAN>.{<SPAN class="element_dynamic">microstepname</SPAN>}</SPAN>.[<SPAN class="element_dynamic">where</SPAN>]</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">params</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">(To be specified if the action is "run") The parameters of the script.<BR><EM>Default value: </EM>empty string</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">custom_operations</SPAN>}</SPAN>.{<SPAN class="element_dynamic">macrostepname</SPAN>}</SPAN>.{<SPAN class="element_dynamic">microstepname</SPAN>}</SPAN>.[<SPAN class="element_dynamic">where</SPAN>]</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">retries</SPAN></SPAN></TD><TD class="parameter_type">Integer</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The number of retries for this custom operation<BR><EM>Default value: </EM>0</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">custom_operations</SPAN>}</SPAN>.{<SPAN class="element_dynamic">macrostepname</SPAN>}</SPAN>.{<SPAN class="element_dynamic">microstepname</SPAN>}</SPAN>.[<SPAN class="element_dynamic">where</SPAN>]</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">scattering</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The scattering kind for this custom operation<BR><EM>Expected values: </EM>tree, chain<BR><EM>Default value: </EM>tree</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">custom_operations</SPAN>}</SPAN>.{<SPAN class="element_dynamic">macrostepname</SPAN>}</SPAN>.{<SPAN class="element_dynamic">microstepname</SPAN>}</SPAN>.[<SPAN class="element_dynamic">where</SPAN>]</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">timeout</SPAN></SPAN></TD><TD class="parameter_type">Integer</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The timeout (seconds) of this custom operation<BR><EM>Default value: </EM>0</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name">{<SPAN class="element_self"><SPAN class="element_normal">resources</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The resources associated with the workflow and their URL</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">resources</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">debug</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">Concatenated debugs</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">resources</SPAN>}</SPAN>.{<SPAN class="element_self"><SPAN class="element_normal">debugs</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">Debugs by node</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">resources</SPAN>}</SPAN>.{<SPAN class="element_normal">debugs</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_dynamic">nodename</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">Debug of node nodename</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">resources</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">error</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">Error message</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">resources</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">output</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">Concatenated outputs</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">resources</SPAN>}</SPAN>.{<SPAN class="element_self"><SPAN class="element_normal">outputs</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">Outputs by cluster</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">resources</SPAN>}</SPAN>.{<SPAN class="element_normal">outputs</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_dynamic">clustername</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">Output of cluster clustername</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">resources</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">state</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">Deployment state of nodes</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">resources</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">status</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">Status of operation's instances (one instance by cluster)</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">wid</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The id# of the workflow that was initiated</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Deploy a recorded environment</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">POST /deployment HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 298
{
  "nodes": [
    "node-1.testbed.lan",
    "node-2.testbed.lan"
  ],
  "environment": {
    "kind": "database",
    "user": "root",
    "name": "debian-base",
    "version": 1
  },
  "ssh_authorized_keys": "/home/frontend/.ssh/authorized_keys",
  "client": "http://frontend.testbed.lan:12345"
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 555
{
  "wid": "D-bf5608b0-9354-446b-a648-c3abaa3cab95",
  "resources": {
    "resource": "/deployment/D-bf5608b0-9354-446b-a648-c3abaa3cab95",
    "log": "/deployment/D-bf5608b0-9354-446b-a648-c3abaa3cab95/logs",
    "logs": {
      "griffon-cluster": "/deployment/D-bf5608b0-9354-446b-a648-c3abaa3cab95/logs/griffon-cluster"
    },
    "state": "/deployment/D-bf5608b0-9354-446b-a648-c3abaa3cab95/state",
    "status": "/deployment/D-bf5608b0-9354-446b-a648-c3abaa3cab95/status",
    "error": "/deployment/D-bf5608b0-9354-446b-a648-c3abaa3cab95/error"
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #2 <SPAN class="example_desc">Perform a simple reboot</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">POST /reboot HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 112
{
  "nodes": [
    "node-1.testbed.lan",
    "node-2.testbed.lan"
  ],
  "kind": "simple",
  "level": "soft"
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 533
{
  "wid": "R-6b7950ee-8889-4e0a-810e-9cb8db5286f7",
  "resources": {
    "resource": "/reboot/R-6b7950ee-8889-4e0a-810e-9cb8db5286f7",
    "log": "/reboot/R-6b7950ee-8889-4e0a-810e-9cb8db5286f7/logs",
    "logs": {
      "graphene-cluster": "/reboot/R-6b7950ee-8889-4e0a-810e-9cb8db5286f7/logs/graphene-cluster"
    },
    "state": "/reboot/R-6b7950ee-8889-4e0a-810e-9cb8db5286f7/state",
    "status": "/reboot/R-6b7950ee-8889-4e0a-810e-9cb8db5286f7/status",
    "error": "/reboot/R-6b7950ee-8889-4e0a-810e-9cb8db5286f7/error"
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #3 <SPAN class="example_desc">Perform a power-off</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">PUT /power HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 92
{
  "nodes": [
    "node-1.testbed.lan",
    "node-2.testbed.lan"
  ],
  "status": "off"
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 527
{
  "wid": "P-e69b39a2-8b5b-416e-b016-7139b5a7e255",
  "resources": {
    "resource": "/power/P-e69b39a2-8b5b-416e-b016-7139b5a7e255",
    "log": "/power/P-e69b39a2-8b5b-416e-b016-7139b5a7e255/logs",
    "logs": {
      "graphene-cluster": "/power/P-e69b39a2-8b5b-416e-b016-7139b5a7e255/logs/graphene-cluster"
    },
    "state": "/power/P-e69b39a2-8b5b-416e-b016-7139b5a7e255/state",
    "status": "/power/P-e69b39a2-8b5b-416e-b016-7139b5a7e255/status",
    "error": "/power/P-e69b39a2-8b5b-416e-b016-7139b5a7e255/error"
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #4 <SPAN class="example_desc">Launch a deployment with some custom operations</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">POST /deployment HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 1360
{
  "nodes": [
    "node-1.testbed.lan",
    "node-2.testbed.lan"
  ],
  "force": true,
  "custom_operations": {
    "SetDeploymentEnvUntrusted": {
      "mount_deploy_part": {
        "substitute": [
          {
            "action": "exec",
            "name": "test-exec",
            "command": "mount ${KADEPLOY_DEPLOY_PART} ${KADEPLOY_ENV_EXTRACTION_DIR}; partprobe ${KADEPLOY_BLOCK_DEVICE}"
          }
        ],
        "post-ops": [
          {
            "action": "send",
            "name": "test-send",
            "file": "/home/frontend/test/_TMP_KATESTSUITE",
            "destination": "/mnt/dest",
            "scattering": "tree"
          }
        ]
      }
    },
    "BroadcastEnvKastafior": {
      "send_environment": {
        "pre-ops": [
          {
            "action": "exec",
            "name": "test-exec",
            "command": "echo OK > ${KADEPLOY_ENV_EXTRACTION_DIR}/TEST_EXEC"
          }
        ],
        "post-ops": [
          {
            "action": "run",
            "name": "test-run",
            "file": "/tmp/script20131009-30803-1cv2y8m"
          }
        ]
      }
    }
  },
  "environment": {
    "kind": "database",
    "user": "root",
    "name": "debian-min",
    "version": 1
  },
  "ssh_authorized_keys": "/home/frontend/.ssh/authorized_keys",
  "client": "http://frontend.testbed.lan:12345"
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 555
{
  "wid": "D-4fd6eeae-d0c3-4d29-ac58-691dd114a63d",
  "resources": {
    "resource": "/deployment/D-4fd6eeae-d0c3-4d29-ac58-691dd114a63d",
    "log": "/deployment/D-4fd6eeae-d0c3-4d29-ac58-691dd114a63d/logs",
    "logs": {
      "graphene-cluster": "/deployment/D-4fd6eeae-d0c3-4d29-ac58-691dd114a63d/logs/graphene-cluster"
    },
    "state": "/deployment/D-4fd6eeae-d0c3-4d29-ac58-691dd114a63d/state",
    "status": "/deployment/D-4fd6eeae-d0c3-4d29-ac58-691dd114a63d/status",
    "error": "/deployment/D-4fd6eeae-d0c3-4d29-ac58-691dd114a63d/error"
  }
}</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Workflow-based operations">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="GET/%OPERATION"><B class="resource_method_GET">GET</B> <SPAN style="font-family: monospace;" class="resource_path">/%OPERATION</SPAN></A></H2><P class="resource_desc">Get the workflow information of every running operation of the kind OPERATION</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_iter">#i</SPAN></SPAN></TD><TD class="field_type"><A href="#type_Workflow">Workflow</A></TD><TD class="field_desc">The list of current operation's worklow information</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Get the list of current deployments</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /deployment HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 578
[
  {
    "id": "D-b9401264-4383-4401-a548-1f881ea14acb",
    "user": "frontend",
    "done": false,
    "error": false,
    "environment": {
      "id": -1,
      "user": "frontend",
      "name": "debian-anon",
      "version": 1
    },
    "logs": false,
    "nodes": {
      "ok": [
      ],
      "ko": [
      ],
      "processing": [
        "node-2.testbed.lan"
      ]
    },
    "time": 30.92
  },
  {
    "id": "D-75105d91-777a-4e3b-bf4e-2690a544031a",
    "user": "root",
    "done": false,
    "error": false,
    "nodes": [
      "node-1.testbed.lan"
    ]
  }
]</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Workflow-based operations">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="GET/%OPERATION/:id"><B class="resource_method_GET">GET</B> <SPAN style="font-family: monospace;" class="resource_path">/%OPERATION/:id</SPAN></A></H2><P class="resource_desc">Get the workflow information (polling) of an operation</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">id</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The id# of the operation</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_dynamic"></SPAN></SPAN></TD><TD class="field_type"><A href="#type_Workflow">Workflow</A></TD><TD class="field_desc">The workflow information related to the operation #:id</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR><TR class="code_frame"><TD class="code_number">404</TD><TD class="code_desc">File not found, the workflow :id cannot be found</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Gather a specific deployment status</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /deployment/D-bed42b5d-f667-4701-adf3-2be22dfe7853 HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 383
{
  "id": "D-bed42b5d-f667-4701-adf3-2be22dfe7853",
  "user": "frontend",
  "done": false,
  "error": false,
  "environment": {
    "id": 3,
    "user": "root",
    "name": "debian-base",
    "version": 1
  },
  "logs": false,
  "nodes": {
    "ok": [
    ],
    "ko": [
    ],
    "processing": [
      "node-1.testbed.lan",
      "node-2.testbed.lan"
    ]
  },
}</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Workflow-based operations">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="GET/%OPERATION/:id/logs/:cluster?"><B class="resource_method_GET">GET</B> <SPAN style="font-family: monospace;" class="resource_path">/%OPERATION/:id/logs/:cluster?</SPAN></A></H2><P class="resource_desc">Get logs of a running operation (the "logs" field was set to true on the workflow's info)</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">id</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The id# of the operation</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">cluster</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The name of the specific cluster to get the logs for</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">String</SPAN>, <SPAN class="response_content">text/plain</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_dynamic"></SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The logs of the current operation prefixed by the timestamp of each line plus '|' in order to be able to sort them</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR><TR class="code_frame"><TD class="code_number">404</TD><TD class="code_desc">File not found, the workflow :id cannot be found</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Gather a specific deployment logs</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /deployment/D-f98782d7-f45b-4895-8bf5-80fd421e5d8d/logs HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: text/plain
Content-Length: 288
1381236580.19466|Launching a deployment on node-1.testbed.lan
1381236580.19626|Performing a Deploy[SetDeploymentEnvUntrusted] step
1381236580.19662|  switch_pxe
1381236580.70964|  reboot
1381236580.70982|   * Performing a soft reboot on node-1.testbed.lan
1381236590.22287|  wait_reboot</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #2 <SPAN class="example_desc">Gather logs of a specific cluster</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /deployment/D-f98782d7-f45b-4895-8bf5-80fd421e5d8d/logs/graphene-cluster HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: text/plain
Content-Length: 1054
1381236711.25015|  create_partition_table
1381236712.76318|  format_deploy_part
1381236716.77628|  mount_deploy_part
1381236717.28898|  format_swap_part
1381236717.78944|End of step Deploy[SetDeploymentEnvUntrusted] after 137s
1381236717.80271|Performing a Deploy[BroadcastEnvKastafior] step
1381236717.80311|  send_environment
1381236730.19086|   * Broadcast time: 13s
1381236730.31649|  manage_admin_post_install
1381236730.82923|  manage_user_post_install
1381236733.34273|  check_kernel_files
1381236733.85569|  install_bootloader
1381236757.87112|  sync
1381236758.37149|End of step Deploy[BroadcastEnvKastafior] after 41s
1381236758.38477|Performing a Deploy[BootNewEnvKexec] step
1381236758.38516|  switch_pxe
1381236758.89467|  umount_deploy_part
1381236759.90749|  mount_deploy_part
1381236760.42154|  kexec
1381236761.43468|  wait_reboot
1381236803.43984|End of step Deploy[BootNewEnvKexec] after 45s
1381236803.45057|End of deployment for node-1.testbed.lan after 223s
1381236803.89096|End of deployment on cluster griffon-cluster after 223s</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Workflow-based operations">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="GET/%OPERATION/:id/debugs/:node?"><B class="resource_method_GET">GET</B> <SPAN style="font-family: monospace;" class="resource_path">/%OPERATION/:id/debugs/:node?</SPAN></A></H2><P class="resource_desc">Gather the command's debugs of some/every nodes (the "debugs" field was set to true on the workflow's info)</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">id</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The id# of the operation</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">node</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The name of the specific node to get the debugs for</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">String</SPAN>, <SPAN class="response_content">text/plain</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_dynamic"></SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The logs of the current operation prefixed by the timestamp of each line plus '|' in order to be able to sort them</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR><TR class="code_frame"><TD class="code_number">404</TD><TD class="code_desc">File not found, the workflow :id cannot be found</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Get debugs of every nodes</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /deployment/D-1267f271-d078-491a-9e2e-f2bfed571c4d/debugs HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
     Content-Type: text/plain
     Content-Length: 5410
     1381238174.79166|-------------------------
     1381238174.79167|NODE: node-1.testbed.lan
     1381238174.79168|-------------------------
     1381238174.79169|COMMAND: taktuk --connector ssh -q -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o PreferredAuthentications=publickey -o ConnectTimeout=12 -o ConnectionAttempts=3 -o BatchMode=yes -i /etc/kadeploy3/keys/id_deploy -l root --dynamic 0 -o output="$type/$pid/$host/".length("$line").":$line"."
" -o error="$type/$pid/$host/".length("$line").":$line"."
" -o status="$type/$pid/$host/".length("$command").":$command".length("$line").":$line"."
" -o connector="$type/$pid/$host/".length("$command").":$command".length("$line").":$line"."
" -o state="$type/$pid/$host/".length("$command").":$command".length("$line").":$line".length("$peer").":$peer"."
" -o info -o message -o taktuk -m 192.168.209.89 -m 192.168.209.90 broadcast exec [ tmp=`mktemp` && chmod 755 ${tmp} && cat - > $tmp && KADEPLOY_CLUSTER="griffon-cluster" KADEPLOY_DEPLOY_PART="/dev/sda3" KADEPLOY_BLOCK_DEVICE="/dev/sda" KADEPLOY_DEPLOY_PART_NUM="3" KADEPLOY_SWAP_PART_NUM="1" KADEPLOY_PROD_PART_NUM="2" KADEPLOY_TMP_PART_NUM="5" KADEPLOY_PREPOST_EXTRACTION_DIR="/rambin" KADEPLOY_TMP_DIR="/tmp" KADEPLOY_ENV="debian-base-http" KADEPLOY_ENV_KERNEL="/vmlinuz" KADEPLOY_ENV_INITRD="/initrd.img" KADEPLOY_ENV_KERNEL_PARAMS="console=tty0 console=ttyS0,19200n8" KADEPLOY_ENV_HYPERVISOR="" KADEPLOY_ENV_HYPERVISOR_PARAMS="" KADEPLOY_OS_KIND="linux" KADEPLOY_PART_TYPE="53" KADEPLOY_FS_TYPE="ext3" KADEPLOY_ENV_EXTRACTION_DIR="/mnt/dest"  ${tmp} ] ; broadcast input file [ /etc/kadeploy3/parted-sample ]
     1381238174.79171|STATUS: 0
     1381238180.50834|-------------------------
     1381238180.50836|NODE: node-1.testbed.lan
     1381238180.50838|-------------------------
     1381238180.50840|COMMAND: taktuk --connector ssh -q -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o PreferredAuthentications=publickey -o ConnectTimeout=12 -o ConnectionAttempts=3 -o BatchMode=yes -i /etc/kadeploy3/keys/id_deploy -l root --dynamic 0 -o output="$type/$pid/$host/".length("$line").":$line"."
" -o error="$type/$pid/$host/".length("$line").":$line"."
" -o status="$type/$pid/$host/".length("$command").":$command".length("$line").":$line"."
" -o connector="$type/$pid/$host/".length("$command").":$command".length("$line").":$line"."
" -o state="$type/$pid/$host/".length("$command").":$command".length("$line").":$line".length("$peer").":$peer"."
" -o info -o message -o taktuk -m 192.168.209.89 -m 192.168.209.90 broadcast exec [ mkdir -p /mnt/dest; umount /dev/sda3 2>/dev/null; mkfs -t ext3 -q -b 4096 -O sparse_super,filetype,resize_inode,dir_index /dev/sda3 ]
     1381238180.50841|STATUS: 0
     1381238174.79151|-------------------------
     1381238174.79155|NODE: node-2.testbed.lan
     1381238174.79157|-------------------------
     1381238174.79161|COMMAND: taktuk --connector ssh -q -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o PreferredAuthentications=publickey -o ConnectTimeout=12 -o ConnectionAttempts=3 -o BatchMode=yes -i /etc/kadeploy3/keys/id_deploy -l root --dynamic 0 -o output="$type/$pid/$host/".length("$line").":$line"."
" -o error="$type/$pid/$host/".length("$line").":$line"."
" -o status="$type/$pid/$host/".length("$command").":$command".length("$line").":$line"."
" -o connector="$type/$pid/$host/".length("$command").":$command".length("$line").":$line"."
" -o state="$type/$pid/$host/".length("$command").":$command".length("$line").":$line".length("$peer").":$peer"."
" -o info -o message -o taktuk -m 192.168.209.89 -m 192.168.209.90 broadcast exec [ tmp=`mktemp` && chmod 755 ${tmp} && cat - > $tmp && KADEPLOY_CLUSTER="griffon-cluster" KADEPLOY_DEPLOY_PART="/dev/sda3" KADEPLOY_BLOCK_DEVICE="/dev/sda" KADEPLOY_DEPLOY_PART_NUM="3" KADEPLOY_SWAP_PART_NUM="1" KADEPLOY_PROD_PART_NUM="2" KADEPLOY_TMP_PART_NUM="5" KADEPLOY_PREPOST_EXTRACTION_DIR="/rambin" KADEPLOY_TMP_DIR="/tmp" KADEPLOY_ENV="debian-base-http" KADEPLOY_ENV_KERNEL="/vmlinuz" KADEPLOY_ENV_INITRD="/initrd.img" KADEPLOY_ENV_KERNEL_PARAMS="console=tty0 console=ttyS0,19200n8" KADEPLOY_ENV_HYPERVISOR="" KADEPLOY_ENV_HYPERVISOR_PARAMS="" KADEPLOY_OS_KIND="linux" KADEPLOY_PART_TYPE="53" KADEPLOY_FS_TYPE="ext3" KADEPLOY_ENV_EXTRACTION_DIR="/mnt/dest"  ${tmp} ] ; broadcast input file [ /etc/kadeploy3/parted-sample ]
     1381238174.79164|STATUS: 0
     1381238180.50823|-------------------------
     1381238180.50827|NODE: node-2.testbed.lan
     1381238180.50829|-------------------------
     1381238180.50830|COMMAND: taktuk --connector ssh -q -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o PreferredAuthentications=publickey -o ConnectTimeout=12 -o ConnectionAttempts=3 -o BatchMode=yes -i /etc/kadeploy3/keys/id_deploy -l root --dynamic 0 -o output="$type/$pid/$host/".length("$line").":$line"."
" -o error="$type/$pid/$host/".length("$line").":$line"."
" -o status="$type/$pid/$host/".length("$command").":$command".length("$line").":$line"."
" -o connector="$type/$pid/$host/".length("$command").":$command".length("$line").":$line"."
" -o state="$type/$pid/$host/".length("$command").":$command".length("$line").":$line".length("$peer").":$peer"."
" -o info -o message -o taktuk -m 192.168.209.89 -m 192.168.209.90 broadcast exec [ mkdir -p /mnt/dest; umount /dev/sda3 2>/dev/null; mkfs -t ext3 -q -b 4096 -O sparse_super,filetype,resize_inode,dir_index /dev/sda3 ]
     1381238180.50833|STATUS: 0</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #2 <SPAN class="example_desc">Get debugs of a specific node</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /deployment/D-1267f271-d078-491a-9e2e-f2bfed571c4d/debugs/node-1.testbed.lan HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: text/plain
Content-Length: 2244
1381237762.64731|-------------------------
1381237762.64738|NODE: node-1.testbed.lan
1381237762.64740|-------------------------
1381237762.64748|COMMAND: ["ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o PreferredAuthentications=publickey -o ConnectTimeout=12 -o ConnectionAttempts=3 -i /var/lib/kadeploy/hostnames/.ssh_key lsarzyniec@kavlan-2.nancy.grid5000.fr "kapower3 -m `cat /var/lib/kadeploy/hostnames/node-1.testbed.lan` --off" && sleep 2 && ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o PreferredAuthentications=publickey -o ConnectTimeout=12 -o ConnectionAttempts=3 -i /var/lib/kadeploy/hostnames/.ssh_key lsarzyniec@kavlan-2.nancy.grid5000.fr "kapower3 -m `cat /var/lib/kadeploy/hostnames/node-1.testbed.lan` --on""]
1381237762.64751|STDOUT: Power operation on the nodes griffon-89.nancy.grid5000.fr
1381237762.64754|STDOUT:   power
1381237762.64757|STDOUT:    * Performing a soft power_off on griffon-89.nancy.grid5000.fr
1381237762.64760|STDOUT:    * Performing a hard power_off on griffon-89.nancy.grid5000.fr
1381237762.64763|STDOUT: Done power operation on the nodes griffon-89.nancy.grid5000.fr
1381237762.64765|STDOUT: 
1381237762.64766|STDOUT: Operation correctly performed on cluster griffon
1381237762.64768|STDOUT: griffon-89.nancy.grid5000.fr
1381237762.64770|STDOUT: Power operation on the nodes griffon-89.nancy.grid5000.fr
1381237762.64772|STDOUT:   power
1381237762.64774|STDOUT:    * Performing a soft power_on on griffon-89.nancy.grid5000.fr
1381237762.64776|STDOUT:    *       /! No soft power_on command is defined for these nodes /! 
1381237762.64778|STDOUT:    * Performing a hard power_on on griffon-89.nancy.grid5000.fr
1381237762.64780|STDOUT: Done power operation on the nodes griffon-89.nancy.grid5000.fr
1381237762.64782|STDOUT: 
1381237762.64783|STDOUT: Operation correctly performed on cluster griffon
1381237762.64785|STDOUT: griffon-89.nancy.grid5000.fr
1381237762.64787|STDERR: Warning: Permanently added 'kavlan-2.nancy.grid5000.fr,172.16.79.121' (RSA) to the list of known hosts.
1381237762.64788|STDERR: Warning: Permanently added 'kavlan-2.nancy.grid5000.fr,172.16.79.121' (RSA) to the list of known hosts.
1381237762.64790|STATUS: 0</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Workflow-based operations">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="GET/%OPERATION/:id/state"><B class="resource_method_GET">GET</B> <SPAN style="font-family: monospace;" class="resource_path">/%OPERATION/:id/state</SPAN></A></H2><P class="resource_desc">Get the state of every nodes in a specific operation. Available when the operation is done.</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">id</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The id# of the operation</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name">{<SPAN class="element_self"><SPAN class="element_dynamic">nodename</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The state of the node nodename</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_dynamic">nodename</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">error</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">If the node is KO, contains the error message</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_dynamic">nodename</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">macro</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The macro-step operation the node is performing</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_dynamic">nodename</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">micro</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The micro-step operation the node is performing</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_dynamic">nodename</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">state</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The state of the node</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR><TR class="code_frame"><TD class="code_number">404</TD><TD class="code_desc">File not found, the workflow :id cannot be found</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Get state of a specific deployment</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /deployment/D-877303c3-e838-4cbf-b7e3-c9862baab93f/state HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 272
{
  "node-1.testbed.lan": {
    "macro": "SetDeploymentEnvUntrusted",
    "micro": "wait_reboot",
    "state": "reboot_in_progress"
  },
  "node-2.testbed.lan": {
    "macro": "SetDeploymentEnvUntrusted",
    "micro": "wait_reboot",
    "state": "reboot_in_progress"
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #2 <SPAN class="example_desc">Get state of a specific power operation</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /power/P-d31fa2c1-d686-4b94-a639-21476a876d64/state HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 184
{
  "node-1.testbed.lan": {
    "macro": "Off",
    "micro": "power",
    "state": "ok"
  },
  "node-2.testbed.lan": {
    "macro": "Off",
    "micro": "power",
    "state": "ok"
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #3 <SPAN class="example_desc">Get state of a deployment that failed</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /power/D-b55916dc-30db-4979-8c67-d83fb1b2cad4/state HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 412
{
  "node-1.testbed.lan": {
    "macro": "SetDeploymentEnvUntrusted",
    "micro": "reboot",
    "state": "ko",
    "error": "SetDeploymentEnvUntrusted-reboot: very_hard_reboot command is not provided"
  },
  "node-2.testbed.lan": {
    "macro": "SetDeploymentEnvUntrusted",
    "micro": "reboot",
    "state": "ko",
    "error": "SetDeploymentEnvUntrusted-reboot: very_hard_reboot command is not provided"
  }
}</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Workflow-based operations">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="GET/%OPERATION/:id/status"><B class="resource_method_GET">GET</B> <SPAN style="font-family: monospace;" class="resource_path">/%OPERATION/:id/status</SPAN></A></H2><P class="resource_desc">Get the global status of an operation (where are every nodes in the operation)</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">id</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The id# of the operation</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name">{<SPAN class="element_self"><SPAN class="element_dynamic">clustername</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The status of the cluster clustername</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_dynamic">clustername</SPAN>}</SPAN>.{<SPAN class="element_self"><SPAN class="element_dynamic">macrostepname</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The status of the macro-step macroname</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_dynamic">clustername</SPAN>}</SPAN>.{<SPAN class="element_dynamic">macrostepname</SPAN>}</SPAN>.{<SPAN class="element_self"><SPAN class="element_dynamic">microstepname</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The status of the micro-step microname</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_dynamic">clustername</SPAN>}</SPAN>.{<SPAN class="element_dynamic">macrostepname</SPAN>}</SPAN>.{<SPAN class="element_dynamic">microstepname</SPAN>}</SPAN>.{<SPAN class="element_self"><SPAN class="element_normal">nodes</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The status of the nodes (of clustername) in the step macroname-microname</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_dynamic">clustername</SPAN>}</SPAN>.{<SPAN class="element_dynamic">macrostepname</SPAN>}</SPAN>.{<SPAN class="element_dynamic">microstepname</SPAN>}</SPAN>.{<SPAN class="element_normal">nodes</SPAN>}</SPAN>.[<SPAN class="element_self"><SPAN class="element_normal">**</SPAN></SPAN>]</TD><TD class="field_type">Array</TD><TD class="field_desc">The nodes that are processing the step</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_dynamic">clustername</SPAN>}</SPAN>.{<SPAN class="element_dynamic">macrostepname</SPAN>}</SPAN>.{<SPAN class="element_dynamic">microstepname</SPAN>}</SPAN>.{<SPAN class="element_normal">nodes</SPAN>}</SPAN>.[<SPAN class="element_self"><SPAN class="element_normal">KO</SPAN></SPAN>]</TD><TD class="field_type">Array</TD><TD class="field_desc">The nodes that have failed the step</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_dynamic">clustername</SPAN>}</SPAN>.{<SPAN class="element_dynamic">macrostepname</SPAN>}</SPAN>.{<SPAN class="element_dynamic">microstepname</SPAN>}</SPAN>.{<SPAN class="element_normal">nodes</SPAN>}</SPAN>.[<SPAN class="element_self"><SPAN class="element_normal">OK</SPAN></SPAN>]</TD><TD class="field_type">Array</TD><TD class="field_desc">The nodes that have successfully done the step</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR><TR class="code_frame"><TD class="code_number">404</TD><TD class="code_desc">File not found, the workflow :id cannot be found</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Get the status of a specific deployment</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /deployment/D-877303c3-e838-4cbf-b7e3-c9862baab93f/status HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 312
{
  "griffon-cluster": {
    "SetDeploymentEnvUntrusted": {
      "wait_reboot": {
        "nodes": {
          "OK": [
          ],
          "KO": [
          ],
          "**": [
            "node-1.testbed.lan",
            "node-2.testbed.lan"
          ]
        },
        "time": 63
      }
    }
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #2 <SPAN class="example_desc">Get the status of a specific power operation</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /power/P-d31fa2c1-d686-4b94-a639-21476a876d64/status HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 285
{
  "graphene-cluster": {
    "Off": {
      "power": {
        "nodes": {
          "OK": [
          ],
          "KO": [
          ],
          "**": [
            "node-1.testbed.lan",
            "node-2.testbed.lan"
          ]
        },
        "time": 14
      }
    }
  }
}</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Workflow-based operations">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="GET/%OPERATION/:id/error"><B class="resource_method_GET">GET</B> <SPAN style="font-family: monospace;" class="resource_path">/%OPERATION/:id/error</SPAN></A></H2><P class="resource_desc">Get the error of an operation (the "error" field was set to true on the workflow's info)</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">id</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The id# of the operation</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">String</SPAN>, <SPAN class="response_content">text/plain</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_dynamic"></SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The error message</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR><TR class="code_frame"><TD class="code_number">404</TD><TD class="code_desc">File not found, the workflow :id cannot be found</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Gather information about a deployment error</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /deployment/D-ec823946-b4fc-4a1f-b7fb-4c24b6a9ef51/error HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 400 Bad Request
X-Application-Error-Code: 5
X-Application-Error-Info: SW52YWxpZCBmaWxlIC0tIFVuYWJsZSB0byBnZXQgdGhlIGNoZWNrc3VtIG9mIGh0dHA6Ly90ZXN0YmVkLmxhbi9kZWJpYW4tYmFzZS1ub25lLnRneiAoaHR0cCBlcnJvciAjNDA0KQ==
Content-Type: text/plain
Content-Length: 104
Invalid file -- Unable to get the checksum of http://testbed.lan/debian-base-none.tgz (http error #404)</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Workflow-based operations">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="DELETE/%OPERATION/:id"><B class="resource_method_DELETE">DELETE</B> <SPAN style="font-family: monospace;" class="resource_path">/%OPERATION/:id</SPAN></A></H2><P class="resource_desc">Cancel a running operation or delete information about one that encountered an error</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">id</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The id# of the operatiooperationn</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">wid</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The id# of the operation that was deleted</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR><TR class="code_frame"><TD class="code_number">404</TD><TD class="code_desc">File not found, the workflow :id cannot be found</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Cancel a specific deployment</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">DELETE /deployment/D-ec823946-b4fc-4a1f-b7fb-4c24b6a9ef51 HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 53
{
  "wid": "D-ec823946-b4fc-4a1f-b7fb-4c24b6a9ef51"
}</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Workflow-based operations">Back to operation</A></P><HR class="operation_inter_sep"></DIV><HR class="operation_sep"><DIV class="operation_frame"><H1 class="operation_title"><A id="Reboot operations">Reboot operations</A></H1><DIV class="operation_index_frame"><H2 class="operation_index_title">Resources</H2><UL class="operation_index_list"><LI><A class="operation_index_link" href="#POST/reboot"><SPAN class="resource_id_method_POST">POST</SPAN> <SPAN class="resource_id_path">/reboot</SPAN></A></LI></UL></DIV><P class="operation_back_link"><A class="operation_back_link" href="#title">Back to title</A></P><HR class="operation_index_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="POST/reboot"><B class="resource_method_POST">POST</B> <SPAN style="font-family: monospace;" class="resource_path">/reboot</SPAN></A></H2><P class="resource_desc">Launch a reboot operation</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">kind</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The kind of reboot to be performed<BR><EM>Expected values: </EM>set_pxe, simple, deploy_env, recorded_env</TD></TR><TR class="parameter_frame"><TD class="parameter_name">[<SPAN class="element_self"><SPAN class="element_normal">nodes</SPAN></SPAN>]</TD><TD class="parameter_type">Array</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The list of nodes the operation should be applied on</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_dynamic">_generic_parameter_</SPAN></SPAN></TD><TD class="parameter_type">...</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Some workflow-based operation's generic parameter (see more <A href="#workflow_operations">here</A>)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">block_device</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The block device the environment has been installed on</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">check_destructive</SPAN></SPAN></TD><TD class="parameter_type">Set</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Check if the last deployed environment has the destructive flag, if it does, do not perform the reboot operation</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">client</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The client used to export files to the server, useful for local:// files (see more <A href="#file_export">here</A>)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">deploy_partition</SPAN></SPAN></TD><TD class="parameter_type">Integer</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The partition the environment has been installed on</TD></TR><TR class="parameter_frame"><TD class="parameter_name">{<SPAN class="element_self"><SPAN class="element_normal">environment</SPAN></SPAN>}</TD><TD class="parameter_type">Hash</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The environment that has been deployed. This field is mandatory when using the kind "recorded_env".</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">level</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The level of the command that will be performed<BR><EM>Expected values: </EM>soft, hard, very_hard<BR><EM>Default value: </EM>soft</TD></TR><TR class="parameter_frame"><TD class="parameter_name">{<SPAN class="element_self"><SPAN class="element_normal">pxe</SPAN></SPAN>}</TD><TD class="parameter_type">Hash</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Specify some custom netboot parameters. This field is mandatory when using the kind "set_pxe".</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">ssh_authorized_keys</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The path to a ssh authorized_keys file that have to be copied in the root directory of the deployed environment (see more <A href="#file_export">here</A>)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">timeout_reboot_classical</SPAN></SPAN></TD><TD class="parameter_type">Integer</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Overwrite the default value for the reboot timeout</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">vlan</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Specify the VLAN the nodes should be reboot in</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">name</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The name of the environment</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">user</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The owner of the environment</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">version</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The version of the environment</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">pxe</SPAN>}</SPAN>.[<SPAN class="element_self"><SPAN class="element_normal">files</SPAN></SPAN>]</TD><TD class="parameter_type">Array</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">A list of path to files that have to be exported in the PXE repository's directory (see more <A href="#file_export">here</A>)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">pxe</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">pxe</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">A custom PXE profile, the string FILES_PREFIX-- will be replaced by the prefix to some exported files</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">pxe</SPAN>}</SPAN>.{<SPAN class="element_self"><SPAN class="element_normal">singularities</SPAN></SPAN>}</TD><TD class="parameter_type">Hash</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Specify a substitution pattern for each node in the PXE profile (the NODE_SINGULARITY pattern must be used in the PXE profile)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">pxe</SPAN>}</SPAN>.{<SPAN class="element_normal">singularities</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_dynamic">nodename</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The substitution pattern for the node "nodename"</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_dynamic"></SPAN></SPAN></TD><TD class="field_type"><A href="#type_Workflow">Workflow</A></TD><TD class="field_desc">Information related to the workflow of the reboot operation</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Perform a simple hard reboot on nodes (do not re-write the PXE profile)</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">POST /reboot HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 112
{
  "nodes": [
    "node-1.testbed.lan",
    "node-2.testbed.lan"
  ],
  "kind": "simple",
  "level": "hard"
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 533
{
  "wid": "R-27714bc3-860d-40e7-8371-b7419f6c9021",
  "resources": {
    "resource": "/reboot/R-27714bc3-860d-40e7-8371-b7419f6c9021",
    "log": "/reboot/R-27714bc3-860d-40e7-8371-b7419f6c9021/logs",
    "logs": {
      "graphene-cluster": "/reboot/R-27714bc3-860d-40e7-8371-b7419f6c9021/logs/graphene-cluster"
    },
    "state": "/reboot/R-27714bc3-860d-40e7-8371-b7419f6c9021/state",
    "status": "/reboot/R-27714bc3-860d-40e7-8371-b7419f6c9021/status",
    "error": "/reboot/R-27714bc3-860d-40e7-8371-b7419f6c9021/error"
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #2 <SPAN class="example_desc">Reboot nodes on the deployment environment and send the user's SSH authorized_keys file</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">POST /reboot HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 229
{
  "nodes": [
    "node-1.testbed.lan",
    "node-2.testbed.lan"
  ],
  "kind": "deploy_env",
  "level": "soft",
  "ssh_authorized_keys": "/home/frontend/.ssh/authorized_keys",
  "client": "http://frontend.testbed.lan:12345"
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 533
{
  "wid": "R-52269f0e-1a5b-4f23-8cbf-0f17b166c420",
  "resources": {
    "resource": "/reboot/R-52269f0e-1a5b-4f23-8cbf-0f17b166c420",
    "log": "/reboot/R-52269f0e-1a5b-4f23-8cbf-0f17b166c420/logs",
    "logs": {
      "graphene-cluster": "/reboot/R-52269f0e-1a5b-4f23-8cbf-0f17b166c420/logs/graphene-cluster"
    },
    "state": "/reboot/R-52269f0e-1a5b-4f23-8cbf-0f17b166c420/state",
    "status": "/reboot/R-52269f0e-1a5b-4f23-8cbf-0f17b166c420/status",
    "error": "/reboot/R-52269f0e-1a5b-4f23-8cbf-0f17b166c420/error"
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #3 <SPAN class="example_desc">Reboot nodes on a (previously installed) recorded environment and check if the partition table was destroyed</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">POST /reboot HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 311
{
  "nodes": [
    "node-1.testbed.lan",
    "node-2.testbed.lan"
  ],
  "kind": "recorded_env",
  "level": "soft",
  "deploy_partition": "3",
  "check_destructive": true,
  "environment": {
    "user": "root",
    "name": "debian-base",
    "version": 1
  },
  "client": "http://frontend.testbed.lan:12345"
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 533
{
  "wid": "R-7b52716a-2b72-4c66-b725-dc9f1726d0a6",
  "resources": {
    "resource": "/reboot/R-7b52716a-2b72-4c66-b725-dc9f1726d0a6",
    "log": "/reboot/R-7b52716a-2b72-4c66-b725-dc9f1726d0a6/logs",
    "logs": {
      "graphene-cluster": "/reboot/R-7b52716a-2b72-4c66-b725-dc9f1726d0a6/logs/graphene-cluster"
    },
    "state": "/reboot/R-7b52716a-2b72-4c66-b725-dc9f1726d0a6/state",
    "status": "/reboot/R-7b52716a-2b72-4c66-b725-dc9f1726d0a6/status",
    "error": "/reboot/R-7b52716a-2b72-4c66-b725-dc9f1726d0a6/error"
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #4 <SPAN class="example_desc">Reboot nodes on a specified kernel using a custom PXE profile with some nodes singularities</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">POST /reboot HTTP/1.1
     Accept: text/plain, application/json
     Host: kadeploy.testbed.lan:25300
     X-Kadeploy-User: frontend
     Content-Type: application/json
     Content-Length: 613
     {
       "nodes": [
         "node-1.testbed.lan",
         "node-2.testbed.lan"
       ],
       "kind": "set_pxe",
       "pxe": {
         "profile": "PROMPT 1
SERIAL 0 19200
DEFAULT bootlabel
DISPLAY messages
TIMEOUT 50
label bootlabel
KERNEL FILES_PREFIX--myvmlinuz
APPEND initrd=FILES_PREFIX--myinitrd console=tty0 console=ttyS0,19200n8 ramdisk_size=290000 id=NODE_SINGULARITY rw noapic
",
         "singularities": {
           "node-1.testbed.lan": "1",
           "node-2.testbed.lan": "2"
         },
         "files": [
           "/home/frontend/myvmlinuz",
           "/home/frontend/myinitrd"
         ]
       },
       "client": "http://frontend.testbed.lan:12345"
     }</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 533
{
  "wid": "R-759f3f78-9742-47e6-b67e-c12b6750c2e4",
  "resources": {
    "resource": "/reboot/R-759f3f78-9742-47e6-b67e-c12b6750c2e4",
    "log": "/reboot/R-759f3f78-9742-47e6-b67e-c12b6750c2e4/logs",
    "logs": {
      "graphene-cluster": "/reboot/R-759f3f78-9742-47e6-b67e-c12b6750c2e4/logs/graphene-cluster"
    },
    "state": "/reboot/R-759f3f78-9742-47e6-b67e-c12b6750c2e4/state",
    "status": "/reboot/R-759f3f78-9742-47e6-b67e-c12b6750c2e4/status",
    "error": "/reboot/R-759f3f78-9742-47e6-b67e-c12b6750c2e4/error"
  }
}</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Reboot operations">Back to operation</A></P><HR class="operation_inter_sep"></DIV><HR class="operation_sep"><DIV class="operation_frame"><H1 class="operation_title"><A id="Rights management">Rights management</A></H1><DIV class="operation_index_frame"><H2 class="operation_index_title">Resources</H2><UL class="operation_index_list"><LI><A class="operation_index_link" href="#POST/rights"><SPAN class="resource_id_method_POST">POST</SPAN> <SPAN class="resource_id_path">/rights</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/rights/:username?/:node?"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/rights/:username?/:node?</SPAN></A></LI><LI><A class="operation_index_link" href="#PUT/rights/:username?/:node?"><SPAN class="resource_id_method_PUT">PUT</SPAN> <SPAN class="resource_id_path">/rights/:username?/:node?</SPAN></A></LI><LI><A class="operation_index_link" href="#DELETE/rights/:username/:node?/:partition?"><SPAN class="resource_id_method_DELETE">DELETE</SPAN> <SPAN class="resource_id_path">/rights/:username/:node?/:partition?</SPAN></A></LI></UL><H2 class="operation_index_title">Return types</H2><DIV class="type_frame"><H3 class="type_title"><A id="type_Rights"><B class="type_name">Rights</B><SPAN class="type_title_desc">(<SPAN class="type_basetype">Hash</SPAN>)</SPAN></A></H3><P class="type_desc">Rights of a specific user on some disks/partitions of some nodes</P><DIV class="type_subframe"><TABLE class="type_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name">{<SPAN class="element_self"><SPAN class="element_dynamic">username</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The user the rights are related to</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_dynamic">username</SPAN>}</SPAN>.[<SPAN class="element_self"><SPAN class="element_dynamic">nodename</SPAN></SPAN>]</TD><TD class="field_type">Array</TD><TD class="field_desc">The node the rights are applied on. If "nodename" is *, the rights are applied on every nodes</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_dynamic">username</SPAN>}</SPAN>.[<SPAN class="element_dynamic">nodename</SPAN>]</SPAN>.<SPAN class="element_self"><SPAN class="element_iter">#i</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">Partitions the rights are granted to. If "partitions" is *, the rights are applied on every disks/partitions</TD></TR></TABLE></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#title">Back to title</A></P><HR class="operation_index_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="POST/rights"><B class="resource_method_POST">POST</B> <SPAN style="font-family: monospace;" class="resource_path">/rights</SPAN></A></H2><P class="resource_desc">Grant the permession to deploy to a specific user on some node's partitions</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name">[<SPAN class="element_self"><SPAN class="element_normal">nodes</SPAN></SPAN>]</TD><TD class="parameter_type">Array</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The list of nodes the rights should be added to. If not specified, rights will be added on all the nodes</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">overwrite</SPAN></SPAN></TD><TD class="parameter_type">Boolean</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Overwrite if some rights are already set for this user</TD></TR><TR class="parameter_frame"><TD class="parameter_name">[<SPAN class="element_self"><SPAN class="element_normal">partitions</SPAN></SPAN>]</TD><TD class="parameter_type">Array</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The partitions/disks the rights should be added to. If the array contains *, rights will be added on every partition/disk</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">username</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The name of the user the rights should be granted. Defaults to "user"</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_dynamic"></SPAN></SPAN></TD><TD class="field_type"><A href="#type_Rights">Rights</A></TD><TD class="field_desc">The rights that was added for the user "username"</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR><TR class="code_frame"><TD class="code_number">400-11</TD><TD class="code_desc">Some elements of the request are conflicting</TD></TR><TR class="code_frame"><TD class="code_number">400-12</TD><TD class="code_desc">No element has been modified</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Grant privileges on every partitions of a specific node</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">POST /rights HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 89
{
  "user" : "root",
  "username": "frontend",
  "nodes": [
    "node-1.testbed.lan"
  ]
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 67
{
  "frontend": {
    "node-1.testbed.lan": [
      "*"
    ]
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #2 <SPAN class="example_desc">Grant privileges on a specific partition of some nodes</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">POST /rights?user=root&overwrite HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 136
{
  "username": "frontend",
  "nodes": [
    "node-1.testbed.lan",
    "node-2.testbed.lan"
  ],
  "partitions": [
    "/dev/sda3"
  ]
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 128
{
  "frontend": {
    "node-1.testbed.lan": [
      "/dev/sda3"
    ],
    "node-2.testbed.lan": [
      "/dev/sda3"
    ]
  }
}</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Rights management">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="GET/rights/:username?/:node?"><B class="resource_method_GET">GET</B> <SPAN style="font-family: monospace;" class="resource_path">/rights/:username?/:node?</SPAN></A></H2><P class="resource_desc">Gather information about someone's deploy permission on nodes</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">node</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The node to check the rights on</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">username</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The name of the user to check the rights for. If not specified, returns the rights of every users</TD></TR><TR class="parameter_frame"><TD class="parameter_name">[<SPAN class="element_self"><SPAN class="element_normal">nodes</SPAN></SPAN>]</TD><TD class="parameter_type">Array</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The list of nodes the rights should be checked on. If nor "node" or "nodes" are specified, rights of all the nodes will be returned. If both "node" and "nodes" are specified, the rights of [nodes]+node will be returned</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_dynamic"></SPAN></SPAN></TD><TD class="field_type"><A href="#type_Rights">Rights</A></TD><TD class="field_desc">The rights of the user "username"</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR><TR class="code_frame"><TD class="code_number">404</TD><TD class="code_desc">File not found, username or node not found</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Get the rights of every users</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /rights?user=root HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 172
{
  "root": {
    "*": [
      "*"
    ]
  },
  "frontend": {
    "node-1.testbed.lan": [
      "/dev/sda3"
    ],
    "node-2.testbed.lan": [
      "/dev/sda3"
    ]
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #2 <SPAN class="example_desc">Get the rights of a specific user</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /rights/frontend?user=root HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 172
{
  "frontend": {
    "node-1.testbed.lan": [
      "/dev/sda3"
    ],
    "node-2.testbed.lan": [
      "/dev/sda3"
    ]
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #3 <SPAN class="example_desc">Get the rights of a specific user on a specific node</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /rights/frontend/node-1.testbed.lan?user=root HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 75
{
  "frontend": {
    "node-1.testbed.lan": [
      "/dev/sda3"
    ]
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #4 <SPAN class="example_desc">Get the rights of a specific user on several nodes</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /rights/frontend?user=root HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 66
{
  "nodes": [
    "node-1.testbed.lan",
    "node-2.testbed.lan"
  ]
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 128
{
  "frontend": {
    "node-1.testbed.lan": [
      "/dev/sda3"
    ],
    "node-2.testbed.lan": [
      "/dev/sda3"
    ]
  }
}</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Rights management">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="PUT/rights/:username?/:node?"><B class="resource_method_PUT">PUT</B> <SPAN style="font-family: monospace;" class="resource_path">/rights/:username?/:node?</SPAN></A></H2><P class="resource_desc">Not implemented ATM</P></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Rights management">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="DELETE/rights/:username/:node?/:partition?"><B class="resource_method_DELETE">DELETE</B> <SPAN style="font-family: monospace;" class="resource_path">/rights/:username/:node?/:partition?</SPAN></A></H2><P class="resource_desc">Remove some rights on some nodes.<BR>If no more rights are remaining on some of the nodes, every operations (workflows) involving this nodes will be killed.</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">username</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The name of the username to remove the rights to</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">node</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The node to remove the rights from</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">partition</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The partitions to remove the rights from (should be urlencoded)</TD></TR><TR class="parameter_frame"><TD class="parameter_name">[<SPAN class="element_self"><SPAN class="element_normal">nodes</SPAN></SPAN>]</TD><TD class="parameter_type">Array</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The list of nodes the rights should removed from. If nor "node" or "nodes" are specified, rights of all the nodes will be removed. If both "node" and "nodes" are specified, the rights of [nodes]+node will be removed</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_dynamic"></SPAN></SPAN></TD><TD class="field_type"><A href="#type_Rights">Rights</A></TD><TD class="field_desc">The rights that was removed</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR><TR class="code_frame"><TD class="code_number">404</TD><TD class="code_desc">File not found, username or node not found</TD></TR><TR class="code_frame"><TD class="code_number">400-11</TD><TD class="code_desc">Some elements of the request are conflicting</TD></TR><TR class="code_frame"><TD class="code_number">400-12</TD><TD class="code_desc">No element has been modified</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Remove the rights on every nodes from a specific user</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">DELETE /rights/frontend?user=root HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 50
{
  "frontend": {
    "*": [
      "*"
    ]
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #2 <SPAN class="example_desc">Remove the rights on a specific node from a specific user</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">DELETE /rights/frontend/node-1.testbed.lan?user=root HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 67
{
  "frontend": {
    "node-1.testbed.lan": [
      "*"
    ]
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #3 <SPAN class="example_desc">Remove the rights on several nodes from a specific user</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">DELETE /rights/frontend?user=root HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 66
{
  "nodes": [
    "node-1.testbed.lan",
    "node-2.testbed.lan"
  ]
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 112
{
  "frontend": {
    "node-1.testbed.lan": [
      "*"
    ],
    "node-2.testbed.lan": [
      "*"
    ]
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #4 <SPAN class="example_desc">Remove the rights on a specific partition of a specific node from a specific user</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">DELETE /rights/frontend?user=root&nodes=node-1.testbed.lan&partitions=%2Fdev%2Fsda3 HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 75
{
  "frontend": {
    "node-1.testbed.lan": [
      "/dev/sda3"
    ]
  }
}</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Rights management">Back to operation</A></P><HR class="operation_inter_sep"></DIV><HR class="operation_sep"><DIV class="operation_frame"><H1 class="operation_title"><A id="Statistics">Statistics</A></H1><DIV class="operation_index_frame"><H2 class="operation_index_title">Resources</H2><UL class="operation_index_list"><LI><A class="operation_index_link" href="#GET/stats/%OPERATION?"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/stats/%OPERATION?</SPAN></A></LI></UL></DIV><P class="operation_back_link"><A class="operation_back_link" href="#title">Back to title</A></P><HR class="operation_index_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="GET/stats/%OPERATION?"><B class="resource_method_GET">GET</B> <SPAN style="font-family: monospace;" class="resource_path">/stats/%OPERATION?</SPAN></A></H2><P class="resource_desc">Gather statistics. The operation can be set to deploy, reboot, power or an empty value</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">date_max</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">Statistics to a specific date date (RFC 2616 format)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">date_min</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">Statistics from a specific date date (RFC 2616 format)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">fields</SPAN></SPAN></TD><TD class="parameter_type">Array</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The fields to be displayed<BR><EM>Expected values: </EM>wid, user, hostname, step1, step2, step3, timeout_step1, timeout_step2, timeout_step3, retry_step1, retry_step2, retry_step3, start, step1_duration, step2_duration, step3_duration, env, md5, success, error<BR><EM>Default value: </EM>["wid", "user", "hostname", "step1", "step2", "step3", "timeout_step1", "timeout_step2", "timeout_step3", "retry_step1", "retry_step2", "retry_step3", "start", "step1_duration", "step2_duration", "step3_duration", "env", "md5", "success", "error"]</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">kind</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The kind of statistics<BR><EM>Expected values: </EM>all, failure_rates<BR><EM>Default value: </EM>all</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">min_failure_rate</SPAN></SPAN></TD><TD class="parameter_type">Float</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The list of nodes which have a specified minimum failure-rate (between 0 and 1). This filter have to be used with the kind <I>failure_rates</I></TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">min_retries</SPAN></SPAN></TD><TD class="parameter_type">Integer</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">Statistics about the nodes that need at least NB attempts to perform specific steps</TD></TR><TR class="parameter_frame"><TD class="parameter_name">[<SPAN class="element_self"><SPAN class="element_normal">nodes</SPAN></SPAN>]</TD><TD class="parameter_type">Array</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The list of nodes to gather the statistics about</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">sort</SPAN></SPAN></TD><TD class="parameter_type">Array</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The fields to sort results by<BR><EM>Expected values: </EM>wid, user, hostname, step1, step2, step3, timeout_step1, timeout_step2, timeout_step3, retry_step1, retry_step2, retry_step3, start, step1_duration, step2_duration, step3_duration, env, md5, success, error<BR><EM>Default value: </EM>["wid", "user", "hostname", "step1", "step2", "step3", "timeout_step1", "timeout_step2", "timeout_step3", "retry_step1", "retry_step2", "retry_step3", "start", "step1_duration", "step2_duration", "step3_duration", "env", "md5", "success", "error"]</TD></TR><TR class="parameter_frame"><TD class="parameter_name">[<SPAN class="element_self"><SPAN class="element_normal">step_retries</SPAN></SPAN>]</TD><TD class="parameter_type">Array</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">Apply the retry filter on the given steps</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">wid</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">Specify the workflow #id</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">String</SPAN>, <SPAN class="response_content">gzipped text/csv or application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_iter">#line</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">A line in the format specified by the <I>fields</I> parameter</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR><TR class="code_frame"><TD class="code_number">404</TD><TD class="code_desc">File not found, invalid operation</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Gather all statistics</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /stats HTTP/1.1
Accept: */*
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: text/csv
Content-Encoding: gzip
Content-Length: 241
---GUNZIPPED---
D-9a87115b-eb7f-45e4-90f2-bec00ccc5dab,frontend,node-1.testbed.lan,SetDeploymentEnvUntrusted,BroadcastEnvKastafior,BootNewEnvKexec,200,200,200,0,0,0,1389347228,165,68,46,debian-base:1,,true,
D-9a87115b-eb7f-45e4-90f2-bec00ccc5dab,frontend,node-2.testbed.lan,SetDeploymentEnvUntrusted,BroadcastEnvKastafior,BootNewEnvKexec,200,200,200,0,0,0,1389347228,165,68,46,debian-base:1,,true,
R-6d5d2255-f533-44a5-a191-ec69fc5f17b9,frontend,node-1.testbed.lan,Simple,,,0,0,0,0,0,0,1389347638,106,0,0,,,true,
R-f6aedfae-12fa-42dd-9c18-6278a9b5ad9d,frontend,node-1.testbed.lan,Simple,,,0,0,0,0,0,0,1389348342,112,0,0,,,true,
R-f6aedfae-12fa-42dd-9c18-6278a9b5ad9d,frontend,node-2.testbed.lan,Simple,,,0,0,0,0,0,0,1389348342,112,0,0,,,true,
P-0073d9d7-d25f-46b1-9b95-d9c4fd52484b,frontend,node-1.testbed.lan,Off,,,0,0,0,0,0,0,1389348732,10,0,0,,,true,
P-0073d9d7-d25f-46b1-9b95-d9c4fd52484b,frontend,node-2.testbed.lan,Off,,,0,0,0,0,0,0,1389348732,10,0,0,,,true,
P-130b8e01-9025-483e-9cb3-2216ea66156d,frontend,node-1.testbed.lan,On,,,0,0,0,0,0,0,1389348781,3,0,0,,,true,
P-130b8e01-9025-483e-9cb3-2216ea66156d,frontend,node-2.testbed.lan,On,,,0,0,0,0,0,0,1389348781,3,0,0,,,true,
---------------</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #2 <SPAN class="example_desc">Gather deployments statistics</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /stats/deploy HTTP/1.1
Accept: */*
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: text/csv
Content-Encoding: gzip
Content-Length: 179
---GUNZIPPED---
D-9a87115b-eb7f-45e4-90f2-bec00ccc5dab,frontend,node-1.testbed.lan,SetDeploymentEnvUntrusted,BroadcastEnvKastafior,BootNewEnvKexec,200,200,200,0,0,0,1389347228,165,68,46,debian-base:1,,true,
D-9a87115b-eb7f-45e4-90f2-bec00ccc5dab,frontend,node-2.testbed.lan,SetDeploymentEnvUntrusted,BroadcastEnvKastafior,BootNewEnvKexec,200,200,200,0,0,0,1389347228,165,68,46,debian-base:1,,true,
---------------</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #3 <SPAN class="example_desc">Gather the list of nodes with a specific failure rate</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /stats?kind=failure_rates&min_failure_rate=0.0 HTTP/1.1
Accept: */*
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 60
{
  "node-1.testbed.lan": 0.0,
  "node-2.testbed.lan": 0.0
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #4 <SPAN class="example_desc">Gather all statistics to a specific date</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /stats?kind=all&date_max=Fri%2C+10+Jan+2014+10%3A10%3A00+GMT HTTP/1.1
Accept: */*
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: text/csv
Content-Encoding: gzip
Content-Length: 264
---GUNZIPPED---
D-9a87115b-eb7f-45e4-90f2-bec00ccc5dab,frontend,node-1.testbed.lan,SetDeploymentEnvUntrusted,BroadcastEnvKastafior,BootNewEnvKexec,200,200,200,0,0,0,1389347228,165,68,46,debian-base:1,,true,
D-9a87115b-eb7f-45e4-90f2-bec00ccc5dab,frontend,node-2.testbed.lan,SetDeploymentEnvUntrusted,BroadcastEnvKastafior,BootNewEnvKexec,200,200,200,0,0,0,1389347228,165,68,46,debian-base:1,,true,
R-6d5d2255-f533-44a5-a191-ec69fc5f17b9,frontend,node-1.testbed.lan,Simple,,,0,0,0,0,0,0,1389347638,106,0,0,,,true,
R-f6aedfae-12fa-42dd-9c18-6278a9b5ad9d,frontend,node-1.testbed.lan,Simple,,,0,0,0,0,0,0,1389348342,112,0,0,,,true,
R-f6aedfae-12fa-42dd-9c18-6278a9b5ad9d,frontend,node-2.testbed.lan,Simple,,,0,0,0,0,0,0,1389348342,112,0,0,,,true,
---------------</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Statistics">Back to operation</A></P><HR class="operation_inter_sep"></DIV><HR class="operation_sep"><DIV class="operation_frame"><H1 class="operation_title"><A id="Nodes information">Nodes information</A></H1><DIV class="operation_index_frame"><H2 class="operation_index_title">Resources</H2><UL class="operation_index_list"><LI><A class="operation_index_link" href="#GET/nodes/:nodename?"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/nodes/:nodename?</SPAN></A></LI></UL><H2 class="operation_index_title">Return types</H2><DIV class="type_frame"><H3 class="type_title"><A id="type_NodeStatus"><B class="type_name">NodeStatus</B><SPAN class="type_title_desc">(<SPAN class="type_basetype">Hash</SPAN>)</SPAN></A></H3><P class="type_desc">Status of nodes</P><DIV class="type_subframe"><TABLE class="type_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name">{<SPAN class="element_self"><SPAN class="element_dynamic">nodename</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The status of the node nodename</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_dynamic">nodename</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">state</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The current state of the node<BR>Possible values: 1, 2, 3, ...</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_dynamic">nodename</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">user</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The last user that deployed the node</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_dynamic">nodename</SPAN>}</SPAN>.{<SPAN class="element_self"><SPAN class="element_normal">environment</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The last environment that was deployed on the node</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_dynamic">nodename</SPAN>}</SPAN>.{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">user</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The owner of the environment</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_dynamic">nodename</SPAN>}</SPAN>.{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">name</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The name of the environment</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_dynamic">nodename</SPAN>}</SPAN>.{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">version</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The version of the environment</TD></TR></TABLE></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#title">Back to title</A></P><HR class="operation_index_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="GET/nodes/:nodename?"><B class="resource_method_GET">GET</B> <SPAN style="font-family: monospace;" class="resource_path">/nodes/:nodename?</SPAN></A></H2><P class="resource_desc">Gather nodes information</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">nodename</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Gather information of a specific node</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">list</SPAN></SPAN></TD><TD class="parameter_type">Boolean</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Ask to return an Array of node names corresponding to the nodes that are managed by the server</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash/Array</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_dynamic"></SPAN></SPAN></TD><TD class="field_type"><A href="#type_NodeStatus">NodeStatus</A></TD><TD class="field_desc">Status of the nodes</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR><TR class="code_frame"><TD class="code_number">404</TD><TD class="code_desc">File not found, nodename not found</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Get the status of every nodes</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /nodes HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 356
{
  "node-1.testbed.lan": {
    "state": "deploying",
    "user": "frontend",
    "environment": {
      "name": "debian-min",
      "version": 1,
      "user": "root"
    }
  },
  "node-2.testbed.lan": {
    "state": "deploying",
    "user": "frontend",
    "environment": {
      "name": "debian-min",
      "version": 1,
      "user": "root"
    }
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #2 <SPAN class="example_desc">Get the status of a specific node</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /nodes/node-1.testbed.lan HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 134
{
  "state": "deployed",
  "user": "frontend",
  "environment": {
    "name": "debian-min",
    "version": 1,
    "user": "root"
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #3 <SPAN class="example_desc">Get the list of nodes</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /nodes?list HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 43
["node-1.testbed.lan", "node-2.testbed.lan"]</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Nodes information">Back to operation</A></P><HR class="operation_inter_sep"></DIV><HR class="operation_sep"><DIV class="operation_frame"><H1 class="operation_title"><A id="Environments management">Environments management</A></H1><DIV class="operation_index_frame"><H2 class="operation_index_title">Resources</H2><UL class="operation_index_list"><LI><A class="operation_index_link" href="#POST/environments"><SPAN class="resource_id_method_POST">POST</SPAN> <SPAN class="resource_id_path">/environments</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/environments?username=:username?&amp;amp;name=:name?&amp;amp;version=:version?"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/environments?username=:username?&name=:name?&version=:version?</SPAN></A></LI><LI><A class="operation_index_link" href="#PUT/environments/:username/:name/:version?"><SPAN class="resource_id_method_PUT">PUT</SPAN> <SPAN class="resource_id_path">/environments/:username/:name/:version?</SPAN></A></LI><LI><A class="operation_index_link" href="#PUT/environments/:username?/:name?/:version?"><SPAN class="resource_id_method_PUT">PUT</SPAN> <SPAN class="resource_id_path">/environments/:username?/:name?/:version?</SPAN></A></LI><LI><A class="operation_index_link" href="#DELETE/environments/:username/:name/:version?"><SPAN class="resource_id_method_DELETE">DELETE</SPAN> <SPAN class="resource_id_path">/environments/:username/:name/:version?</SPAN></A></LI></UL><H2 class="operation_index_title">Return types</H2><DIV class="type_frame"><H3 class="type_title"><A id="type_Environment"><B class="type_name">Environment</B><SPAN class="type_title_desc">(<SPAN class="type_basetype">Hash</SPAN>)</SPAN></A></H3><P class="type_desc">The description of an environment</P><DIV class="type_subframe"><TABLE class="type_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">user</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The owner of the environment</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">name</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The name of the environment</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">os</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The operating system of the environment<BR>Possible values: linux, xen, other</TD></TR><TR class="field_frame"><TD class="field_name">{<SPAN class="element_self"><SPAN class="element_normal">image</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The image file that contains the environment</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">image</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">file</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The path to the image file (see more <A href="#file_export">here</A>)</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">image</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">kind</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The kind of image<BR>Possible values: tar, dd, fsa</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">image</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">compression</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The compression algorithm used to compress the image<BR>Possible values: gzip, bzip2, xz</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">version</SPAN></SPAN></TD><TD class="field_type">Integer</TD><TD class="field_desc">The version of the environment</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">description</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The description of the environment</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">author</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The author of the environment</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">visibility</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The visibility of the environment<BR>Possible values: public, private, shared</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">destructive</SPAN></SPAN></TD><TD class="field_type">Boolean</TD><TD class="field_desc">The environment destruct the disk partitioning</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">multipart</SPAN></SPAN></TD><TD class="field_type">Boolean</TD><TD class="field_desc">The environment image is a multi-partitioned archive</TD></TR><TR class="field_frame"><TD class="field_name">{<SPAN class="element_self"><SPAN class="element_normal">preinstall</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">A preinstall script archive</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">preinstall</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">file</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The path to the archive file (see more <A href="#file_export">here</A>)</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">preinstall</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">compression</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The compression algorithm used to compress the archive<BR>Possible values: gzip, bzip2, xz</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">preinstall</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">script</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">Path to a script (inside the archive) that will be launched during the pre-install step</TD></TR><TR class="field_frame"><TD class="field_name">[<SPAN class="element_self"><SPAN class="element_normal">postinstalls</SPAN></SPAN>]</TD><TD class="field_type">Array</TD><TD class="field_desc">A list of postinstall script archives</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">[<SPAN class="element_normal">postinstalls</SPAN>]</SPAN>.{<SPAN class="element_self"><SPAN class="element_iter">#i</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">A postinstall script archive</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent">[<SPAN class="element_normal">postinstalls</SPAN>]</SPAN>.{<SPAN class="element_iter">#i</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">file</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The path to the archive file (see more <A href="#file_export">here</A>)</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent">[<SPAN class="element_normal">postinstalls</SPAN>]</SPAN>.{<SPAN class="element_iter">#i</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">compression</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The compression algorithm used to compress the archive<BR>Possible values: gzip, bzip2, xz</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent">[<SPAN class="element_normal">postinstalls</SPAN>]</SPAN>.{<SPAN class="element_iter">#i</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">script</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">Path to a script (inside the archive) that will be launched during the post-install step</TD></TR><TR class="field_frame"><TD class="field_name">{<SPAN class="element_self"><SPAN class="element_normal">boot</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The environment's boot parameters</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">boot</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">kernel</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">Path to the kernel file (inside the environment\s image)</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">boot</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">initrd</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">Path to the initrd file (inside the environment\s image)</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">boot</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">kernel_params</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The parameters to be given to the kernel at launch time</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">boot</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">hypervisor</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">Path to the hypervisor file (inside the environment\s image), useful when deploying Xen environments</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">boot</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">hypervisor_params</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The parameters to be given to the hypervisor at launch time, useful when deploying Xen environments</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">boot</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">block_device</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The block device environment should be installed on, useful for multi-partitioned environments</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">boot</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">deploy_part</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The partition the environment should be installed on, useful for multi-partitioned environments</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">partition_type</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The partition type that will be set when partitioning the disk</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">filesystem</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The filesystem type of the environment, useful for tar environments</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">options</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">Custom options</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_normal">options</SPAN></SPAN>.[<SPAN class="element_self"><SPAN class="element_normal">partitions</SPAN></SPAN>]</TD><TD class="field_type">Array</TD><TD class="field_desc">A list of id/partition association</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_normal">options</SPAN></SPAN>.[<SPAN class="element_normal">partitions</SPAN>]</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">id</SPAN></SPAN></TD><TD class="field_type">Integer</TD><TD class="field_desc">The id of the partition inside the compressed archive</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_normal">options</SPAN></SPAN>.[<SPAN class="element_normal">partitions</SPAN>]</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">device</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The physical device this archive part should be installed on</TD></TR></TABLE></DIV><H3 class="type_subtitle">Example #1</H3><PRE class="code_sample">{
  "name": "debian-custom",
  "version": 2,
  "visibility": "private",
  "destructive": false,
  "os": "linux",
  "image": {
    "file": "http://testbed.lan/debian-base.tgz",
    "kind": "tar",
    "compression": "gzip"
  },
  "boot": {
    "kernel": "/boot/vmlinuz",
    "initrd": "/boot/initrd.img"
  },
  "filesystem": "ext4",
  "partition_type": 0,
  "multipart": false,
}</PRE><H3 class="type_subtitle">Example #2</H3><PRE class="code_sample">{
  "name": "debian-base",
  "version": 2,
  "description": "My custom Debian 7",
  "author": "frontend@testbed.lan",
  "visibility": "shared",
  "destructive": false,
  "os": "linux",
  "image": {
    "file": "/home/frontend/debian-base.tgz",
    "kind": "tar",
    "compression": "gzip"
  },
  "postinstalls": [
    {
      "archive": "/home/frontend/debian-base-postinstall.tgz",
      "compression": "gzip",
      "script": "traitement.ash /rambin"
    }
  ],
  "boot": {
    "kernel": "/vmlinuz",
    "initrd": "/initrd.img"
  },
  "filesystem": "ext3",
  "partition_type": 83,
  "multipart": false
}</PRE><H3 class="type_subtitle">Example #3</H3><PRE class="code_sample">{
  "environment": {
    "name": "debian-base",
    "version": 2,
    "multipart": true,
    "os": "linux",
    "image": {
      "file": "server:///tmp/debian-base.fsa",
      "kind": "fsa",
      "compression": 3
    },
    "boot": {
      "kernel": "/vmlinuz",
      "initrd": "/initrd.img",
      "block_device": "/dev/sda",
      "partition": 2
    },
    "filesystem": "ext3",
    "options": {
      "partitions": [
        {
          "id": 0,
          "device": "/dev/sda1"
        },
        {
          "id": 1,
          "device": "/dev/sda2"
        },
        {
          "id": 2,
          "device": "/dev/sda3"
        }
      ]
    }
  }
}</PRE></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#title">Back to title</A></P><HR class="operation_index_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="POST/environments"><B class="resource_method_POST">POST</B> <SPAN style="font-family: monospace;" class="resource_path">/environments</SPAN></A></H2><P class="resource_desc"></P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name">{<SPAN class="element_self"><SPAN class="element_normal">environment</SPAN></SPAN>}</TD><TD class="parameter_type">Hash</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The environment to add</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">client</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The client used to export files to the server, useful for local:// files (see more <A href="#file_export">here</A>)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.{<SPAN class="element_self"><SPAN class="element_normal">image</SPAN></SPAN>}</TD><TD class="parameter_type">Hash</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The image file that contains the environment</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">name</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The name of the environment</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">os</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The operating system of the environment<BR><EM>Expected values: </EM>linux, xen, other</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">author</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The author of the environment<BR><EM>Default value: </EM>empty string</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.{<SPAN class="element_self"><SPAN class="element_normal">boot</SPAN></SPAN>}</TD><TD class="parameter_type">Hash</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The environment's boot parameters</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">description</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The description of the environment<BR><EM>Default value: </EM>empty string</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">destructive</SPAN></SPAN></TD><TD class="parameter_type">Boolean</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The environment destruct the disk partitioning<BR><EM>Default value: </EM>false</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">filesystem</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The filesystem type of the environment, useful for tar environments<BR><EM>Default value: </EM>empty string</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">multipart</SPAN></SPAN></TD><TD class="parameter_type">Boolean</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The environment image is a multi-partitioned archive<BR><EM>Default value: </EM>false</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">options</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Custom options</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">partition_type</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The partition type that will be set when partitioning the disk<BR><EM>Default value: </EM>0</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.[<SPAN class="element_self"><SPAN class="element_normal">postinstalls</SPAN></SPAN>]</TD><TD class="parameter_type">Array</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">A list of postinstall script archives</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.{<SPAN class="element_self"><SPAN class="element_normal">preinstall</SPAN></SPAN>}</TD><TD class="parameter_type">Hash</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">A preinstall script archive</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">version</SPAN></SPAN></TD><TD class="parameter_type">Integer</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The version of the environment<BR><EM>Default value: </EM>1</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">visibility</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The visibility of the environment<BR><EM>Expected values: </EM>public, private, shared<BR><EM>Default value: </EM>private</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.{<SPAN class="element_normal">boot</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">block_device</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The block device environment should be installed on, useful for multi-partitioned environments<BR><EM>Default value: </EM>empty string</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.{<SPAN class="element_normal">boot</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">deploy_part</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The partition the environment should be installed on, useful for multi-partitioned environments<BR><EM>Default value: </EM>empty string</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.{<SPAN class="element_normal">boot</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">hypervisor</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Path to the hypervisor file (inside the environment\s image), useful when deploying Xen environments<BR><EM>Default value: </EM>empty string</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.{<SPAN class="element_normal">boot</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">hypervisor_params</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The parameters to be given to the hypervisor at launch time, useful when deploying Xen environments<BR><EM>Default value: </EM>empty string</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.{<SPAN class="element_normal">boot</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">initrd</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Path to the initrd file (inside the environment\s image)<BR><EM>Default value: </EM>empty string</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.{<SPAN class="element_normal">boot</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">kernel</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Path to the kernel file (inside the environment\s image)<BR><EM>Default value: </EM>empty string</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.{<SPAN class="element_normal">boot</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">kernel_params</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The parameters to be given to the kernel at launch time<BR><EM>Default value: </EM>empty string</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.{<SPAN class="element_normal">image</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">compression</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The compression algorithm used to compress the image<BR><EM>Expected values: </EM>gzip, bzip2, xz</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.{<SPAN class="element_normal">image</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">file</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The path to the image file (see more <A href="#file_export">here</A>)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.{<SPAN class="element_normal">image</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">kind</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The kind of image<BR><EM>Expected values: </EM>tar, dd, fsa</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_normal">options</SPAN></SPAN>.[<SPAN class="element_self"><SPAN class="element_normal">partitions</SPAN></SPAN>]</TD><TD class="parameter_type">Array</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">A list of id/partition association</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_normal">options</SPAN></SPAN>.[<SPAN class="element_normal">partitions</SPAN>]</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">device</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The physical device this archive part should be installed on</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_normal">options</SPAN></SPAN>.[<SPAN class="element_normal">partitions</SPAN>]</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">id</SPAN></SPAN></TD><TD class="parameter_type">Integer</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The id of the partition inside the compressed archive</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.[<SPAN class="element_normal">postinstalls</SPAN>]</SPAN>.{<SPAN class="element_iter">#i</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">compression</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The compression algorithm used to compress the archive<BR><EM>Expected values: </EM>gzip, bzip2, xz</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.[<SPAN class="element_normal">postinstalls</SPAN>]</SPAN>.{<SPAN class="element_iter">#i</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">file</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The path to the archive file (see more <A href="#file_export">here</A>)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.[<SPAN class="element_normal">postinstalls</SPAN>]</SPAN>.{<SPAN class="element_iter">#i</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">script</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">Path to a script (inside the archive) that will be launched during the post-install step<BR><EM>Default value: </EM>none</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.[<SPAN class="element_normal">postinstalls</SPAN>]</SPAN>.{<SPAN class="element_self"><SPAN class="element_iter">#i</SPAN></SPAN>}</TD><TD class="parameter_type">Hash</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">A postinstall script archive</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.{<SPAN class="element_normal">preinstall</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">compression</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The compression algorithm used to compress the archive<BR><EM>Expected values: </EM>gzip, bzip2, xz</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.{<SPAN class="element_normal">preinstall</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">file</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The path to the archive file (see more <A href="#file_export">here</A>)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.{<SPAN class="element_normal">preinstall</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">script</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">Path to a script (inside the archive) that will be launched during the pre-install step<BR><EM>Default value: </EM>none</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_dynamic"></SPAN></SPAN></TD><TD class="field_type"><A href="#type_Environment">Environment</A></TD><TD class="field_desc">The environment that was added</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR><TR class="code_frame"><TD class="code_number">400-6</TD><TD class="code_desc">Invalid environment, something went wrong with the environment description checking, check the error message</TD></TR><TR class="code_frame"><TD class="code_number">400-9</TD><TD class="code_desc">Invalid content, check your JSON's structure</TD></TR><TR class="code_frame"><TD class="code_number">400-10</TD><TD class="code_desc">Already existing element, an environment with the same user/name/version already exists</TD></TR><TR class="code_frame"><TD class="code_number">400-12</TD><TD class="code_desc">Nothing modified</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Create a basic environment (the image's archive is exported from the client to the server)</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">POST /environments HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 731
{
  "client": "http://frontend.testbed.lan:12345",
  "environment": {
    "name": "debian-base",
    "version": 2,
    "description": "My custom Debian 7",
    "author": "frontend@testbed.lan",
    "visibility": "shared",
    "destructive": false,
    "os": "linux",
    "image": {
      "file": "/home/frontend/debian-base.tgz",
      "kind": "tar",
      "compression": "gzip"
    },
    "postinstalls": [
      {
        "archive": "/home/frontend/debian-base-postinstall.tgz",
        "compression": "gzip",
        "script": "traitement.ash /rambin"
      }
    ],
    "boot": {
      "kernel": "/vmlinuz",
      "initrd": "/initrd.img"
    },
    "filesystem": "ext3",
    "partition_type": 83,
    "multipart": false
  }
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 605
{
  "name": "debian-base",
  "version": 2,
  "description": "My custom Debian 7",
  "author": "frontend@testbed.lan",
  "visibility": "shared",
  "destructive": false,
  "os": "linux",
  "image": {
    "file": "/home/frontend/debian-base.tgz",
    "kind": "tar",
    "compression": "gzip"
  },
  "postinstalls": [
    {
      "archive": "/home/frontend/debian-base-postinstall.tgz",
      "compression": "gzip",
      "script": "traitement.ash /rambin"
    }
  ],
  "boot": {
    "kernel": "/vmlinuz",
    "initrd": "/initrd.img"
  },
  "filesystem": "ext3",
  "partition_type": 83,
  "multipart": false
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #2 <SPAN class="example_desc">Create a minimal environment (the image's archive is accessible on HTTP)</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">POST /environments HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 301
{
  "environment": {
    "name": "debian-base",
    "os": "linux",
    "image": {
      "file": "http://testbed.lan/debian-base.tgz",
      "kind": "tar",
      "compression": "gzip"
    },
    "boot": {
      "kernel": "/vmlinuz",
      "initrd": "/initrd.img"
    },
    "filesystem": "ext3"
  }
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 364
{
  "name": "debian-base",
  "version": 1,
  "visibility": "private",
  "destructive": false,
  "os": "linux",
  "image": {
    "file": "http://testbed.lan/debian-base.tgz",
    "kind": "tar",
    "compression": "gzip"
  },
  "boot": {
    "kernel": "/vmlinuz",
    "initrd": "/initrd.img"
  },
  "filesystem": "ext3",
  "partition_type": 0,
  "multipart": false
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #3 <SPAN class="example_desc">Create a multi-partitioned environment (the image's archive is stored on the server)</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">POST /environments HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 657
{
  "environment": {
    "name": "debian-base",
    "version": 2,
    "multipart": true,
    "os": "linux",
    "image": {
      "file": "server:///tmp/debian-base.fsa",
      "kind": "fsa",
      "compression": 3
    },
    "boot": {
      "kernel": "/vmlinuz",
      "initrd": "/initrd.img",
      "block_device": "/dev/sda",
      "partition": 2
    },
    "filesystem": "ext3",
    "options": {
      "partitions": [
        {
          "id": 0,
          "device": "/dev/sda1"
        },
        {
          "id": 1,
          "device": "/dev/sda2"
        },
        {
          "id": 2,
          "device": "/dev/sda3"
        }
      ]
    }
  }
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 642
{
  "name": "debian-base",
  "version": 2,
  "visibility": "private",
  "destructive": false,
  "os": "linux",
  "image": {
    "file": "server:///tmp/debian-base.fsa",
    "kind": "fsa",
    "compression": 3
  },
  "boot": {
    "kernel": "/vmlinuz",
    "initrd": "/initrd.img",
    "block_device": "/dev/sda",
    "partition": 2
  },
  "filesystem": "ext3",
  "partition_type": 0,
  "multipart": true,
  "options": {
    "partitions": [
      {
        "id": 0,
        "device": "/dev/sda1"
      },
      {
        "id": 1,
        "device": "/dev/sda2"
      },
      {
        "id": 2,
        "device": "/dev/sda3"
      }
    ]
  }
}</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Environments management">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="GET/environments?username=:username?&amp;amp;name=:name?&amp;amp;version=:version?"><B class="resource_method_GET">GET</B> <SPAN style="font-family: monospace;" class="resource_path">/environments?username=:username?&name=:name?&version=:version?</SPAN></A></H2><P class="resource_desc">Gather the description of environments. If no user is given, the public environment will be displayed, otherwise a list of all environments that are public or owned by the user will be returned. The :username or the :name fields have to be encoded following the RFC 3986 specifications (non-ASCII characters are encoded with a percent notation)</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">name</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The name of the environment</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">username</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The owner of the environment</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">version</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The version of the environment</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">last</SPAN></SPAN></TD><TD class="parameter_type">Set</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Show the last version of environments (by default every versions are returned)</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Array</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_iter">#i</SPAN></SPAN></TD><TD class="field_type"><A href="#type_Environment">Environment</A></TD><TD class="field_desc">One of the environment that were matching the request's parameters</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR><TR class="code_frame"><TD class="code_number">404</TD><TD class="code_desc">File not found, the resource you are looking for cannot be found</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Get the list of all visible environments</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /environments HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 1589
[
  {
    "name": "debian-base",
    "version": 1,
    "description": "Debian 6. https://www.grid5000.fr/mediawiki/index.php/Squeeze-x64-base-1.0",
    "author": "support-staff@lists.grid5000.fr",
    "visibility": "public",
    "destructive": false,
    "os": "linux",
    "image": {
      "file": "/var/lib/kadeploy/envs/images/squeeze-x64-base-1.6.tgz",
      "kind": "tar",
      "compression": "gzip"
    },
    "postinstalls": [
      {
        "archive": "/var/lib/kadeploy/envs/install_scripts/debian-x64-base-2.4-post.tgz",
        "compression": "gzip",
        "script": "traitement.ash /rambin"
      }
    ],
    "boot": {
      "kernel": "/vmlinuz",
      "initrd": "/initrd.img"
    },
    "filesystem": "ext3",
    "partition_type": 83,
    "multipart": false,
    "user": "root"
  },
  {
    "name": "debian-min-http",
    "version": 1,
    "description": "Debian 6. https://www.grid5000.fr/mediawiki/index.php/Squeeze-x64-base-1.0",
    "author": "support-staff@lists.grid5000.fr",
    "visibility": "public",
    "destructive": false,
    "os": "linux",
    "image": {
      "file": "http://kadeploy.testbed.lan/squeeze-x64-min-1.4.tgz",
      "kind": "tar",
      "compression": "gzip"
    },
    "postinstalls": [
      {
        "archive": "http://kadeploy.testbed.lan/debian-x64-min-1.1-post.tgz",
        "compression": "gzip",
        "script": "traitement.ash /rambin"
      }
    ],
    "boot": {
      "kernel": "/vmlinuz",
      "initrd": "/initrd.img"
    },
    "filesystem": "ext3",
    "partition_type": 83,
    "multipart": false,
    "user": "root"
  }
]</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #2 <SPAN class="example_desc">Get the list of the environments a specified user can see</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /environments?username=frontend HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 2029
[
  {
    "name": "debian-custom",
    "version": 2,
    "visibility": "private",
    "destructive": false,
    "os": "linux",
    "image": {
      "file": "http://testbed.lan/debian-base.tgz",
      "kind": "tar",
      "compression": "gzip"
    },
    "boot": {
      "kernel": "/boot/vmlinuz",
      "initrd": "/boot/initrd.img"
    },
    "filesystem": "ext4",
    "partition_type": 0,
    "multipart": false,
    "user": "frontend"
  },
  {
    "name": "debian-base",
    "version": 1,
    "description": "Debian 6. https://www.grid5000.fr/mediawiki/index.php/Squeeze-x64-base-1.0",
    "author": "support-staff@lists.grid5000.fr",
    "visibility": "public",
    "destructive": false,
    "os": "linux",
    "image": {
      "file": "/var/lib/kadeploy/envs/images/squeeze-x64-base-1.6.tgz",
      "kind": "tar",
      "compression": "gzip"
    },
    "postinstalls": [
      {
        "archive": "/var/lib/kadeploy/envs/install_scripts/debian-x64-base-2.4-post.tgz",
        "compression": "gzip",
        "script": "traitement.ash /rambin"
      }
    ],
    "boot": {
      "kernel": "/vmlinuz",
      "initrd": "/initrd.img"
    },
    "filesystem": "ext3",
    "partition_type": 83,
    "multipart": false,
    "user": "root"
  },
  {
    "name": "debian-min-http",
    "version": 1,
    "description": "Debian 6. https://www.grid5000.fr/mediawiki/index.php/Squeeze-x64-base-1.0",
    "author": "support-staff@lists.grid5000.fr",
    "visibility": "public",
    "destructive": false,
    "os": "linux",
    "image": {
      "file": "http://kadeploy.testbed.lan/squeeze-x64-min-1.4.tgz",
      "kind": "tar",
      "compression": "gzip"
    },
    "postinstalls": [
      {
        "archive": "http://kadeploy.testbed.lan/debian-x64-min-1.1-post.tgz",
        "compression": "gzip",
        "script": "traitement.ash /rambin"
      }
    ],
    "boot": {
      "kernel": "/vmlinuz",
      "initrd": "/initrd.img"
    },
    "filesystem": "ext3",
    "partition_type": 83,
    "multipart": false,
    "user": "root"
  }
]</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #3 <SPAN class="example_desc">Get the description of a specific environment</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /environments?username=frontend&name=debian-custom HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 442
[
  {
    "name": "debian-custom",
    "version": 2,
    "visibility": "private",
    "destructive": false,
    "os": "linux",
    "image": {
      "file": "http://testbed.lan/debian-base.tgz",
      "kind": "tar",
      "compression": "gzip"
    },
    "boot": {
      "kernel": "/boot/vmlinuz",
      "initrd": "/boot/initrd.img"
    },
    "filesystem": "ext4",
    "partition_type": 0,
    "multipart": false,
    "user": "frontend"
  }
]</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #4 <SPAN class="example_desc">Get the description of a specific version of a specific environment</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /environments?username=frontend&name=debian-custom&version=1 HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 432
[
  {
    "name": "debian-custom",
    "version": 1,
    "visibility": "private",
    "destructive": false,
    "os": "linux",
    "image": {
      "file": "http://testbed.lan/debian-base.tgz",
      "kind": "tar",
      "compression": "gzip"
    },
    "boot": {
      "kernel": "/vmlinuz",
      "initrd": "/initrd.img"
    },
    "filesystem": "ext3",
    "partition_type": 0,
    "multipart": false,
    "user": "frontend"
  }
]</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #5 <SPAN class="example_desc">Get the description of every debian-custom</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /environments?name=debian-custom HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 872
[
  {
    "name": "debian-custom",
    "version": 1,
    "visibility": "private",
    "destructive": false,
    "os": "linux",
    "image": {
      "file": "http://testbed.lan/debian-base.tgz",
      "kind": "tar",
      "compression": "gzip"
    },
    "boot": {
      "kernel": "/vmlinuz",
      "initrd": "/initrd.img"
    },
    "filesystem": "ext3",
    "partition_type": 0,
    "multipart": false,
    "user": "frontend"
  },
  {
    "name": "debian-custom",
    "version": 2,
    "visibility": "private",
    "destructive": false,
    "os": "linux",
    "image": {
      "file": "http://testbed.lan/debian-base.tgz",
      "kind": "tar",
      "compression": "gzip"
    },
    "boot": {
      "kernel": "/boot/vmlinuz",
      "initrd": "/boot/initrd.img"
    },
    "filesystem": "ext4",
    "partition_type": 0,
    "multipart": false,
    "user": "frontend"
  }
]</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Environments management">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="PUT/environments/:username/:name/:version?"><B class="resource_method_PUT">PUT</B> <SPAN style="font-family: monospace;" class="resource_path">/environments/:username/:name/:version?</SPAN></A></H2><P class="resource_desc">Modify some environment(s) properties, returns the modified environment. If no version is specified, modify the last version. The :username or the :name fields have to be encoded following the RFC 3986 specifications (non-ASCII characters are encoded with a percent notation)</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">name</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The name of the environment, mandatory if the operation is not update_file</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">username</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The owner of the environment, mandatory if the operation is not update_file</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">version</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The version of the environment</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">client</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The client used to export files to the server, needed to update the checksum of local:// files (see more <A href="#file_export">here</A>)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">toggle_destructive</SPAN></SPAN></TD><TD class="parameter_type">Set</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Toggle the destructive flag</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">update_image_checksum</SPAN></SPAN></TD><TD class="parameter_type">Set</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Update the checksum of the image's archive in the database (the server will get the checksum of the recorded archive file)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">update_postinstalls_checksum</SPAN></SPAN></TD><TD class="parameter_type">Set</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Update the checksum of the preinstall's archive(s) in the database (the server will get the checksum of the recorded archive file)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">update_preinstall_checksum</SPAN></SPAN></TD><TD class="parameter_type">Set</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Update the checksum of the preinstall's archive in the database (the server will get the checksum of the recorded archive file)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">visibility</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Set the visibility of the environment</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash/Array</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_dynamic"></SPAN></SPAN></TD><TD class="field_type"><A href="#type_Environment">Environment</A></TD><TD class="field_desc">The environment that was modified</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR><TR class="code_frame"><TD class="code_number">400-9</TD><TD class="code_desc">Invalid content, check your JSON's structure</TD></TR><TR class="code_frame"><TD class="code_number">400-12</TD><TD class="code_desc">Nothing modified</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Change the visibility flag of an environment</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">PUT /environments/frontend/debian-custom HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 30
{
  "visibility": "shared"
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 375
{
  "name": "debian-custom",
  "version": 2,
  "visibility": "shared",
  "destructive": false,
  "os": "linux",
  "image": {
    "file": "http://testbed.lan/debian-base.tgz",
    "kind": "tar",
    "compression": "gzip"
  },
  "boot": {
    "kernel": "/boot/vmlinuz",
    "initrd": "/boot/initrd.img"
  },
  "filesystem": "ext4",
  "partition_type": 0,
  "multipart": false
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #2 <SPAN class="example_desc">Tell the server to gather the new checksum of the image's archive</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">PUT /environments/frontend/debian-custom?update_image_checksum HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 369
{
  "name": "debian-custom",
  "version": 1,
  "visibility": "shared",
  "destructive": false,
  "os": "linux",
  "image": {
    "file": "http://www.testbed.lan/debian-base.tgz",
    "kind": "tar",
    "compression": "gzip"
  },
  "boot": {
    "kernel": "/vmlinuz",
    "initrd": "/initrd.img"
  },
  "filesystem": "ext3",
  "partition_type": 0,
  "multipart": false
}</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Environments management">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="PUT/environments/:username?/:name?/:version?"><B class="resource_method_PUT">PUT</B> <SPAN style="font-family: monospace;" class="resource_path">/environments/:username?/:name?/:version?</SPAN></A></H2><P class="resource_desc">Modify some environment(s) properties, returns the modified environment. If no version is specified, modify the last version. The :username or the :name fields have to be encoded following the RFC 3986 specifications (non-ASCII characters are encoded with a percent notation)</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">name</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The name of the environment, mandatory if the operation is not update_file</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">username</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The owner of the environment, mandatory if the operation is not update_file</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">version</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The version of the environment</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">client</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The client used to export files to the server, needed to update the checksum of local:// files (see more <A href="#file_export">here</A>)</TD></TR><TR class="parameter_frame"><TD class="parameter_name">{<SPAN class="element_self"><SPAN class="element_normal">update_files</SPAN></SPAN>}</TD><TD class="parameter_type">Hash</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Batch renaming of file's paths, admins only</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">update_files</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_dynamic">old_path_prefix</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The new path prefix</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash/Array</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_dynamic"></SPAN></SPAN></TD><TD class="field_type"><A href="#type_Environment">Environment</A></TD><TD class="field_desc">The environment that was modified</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR><TR class="code_frame"><TD class="code_number">400-9</TD><TD class="code_desc">Invalid content, check your JSON's structure</TD></TR><TR class="code_frame"><TD class="code_number">400-12</TD><TD class="code_desc">Nothing modified</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Change the path to some files on all the environments</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">PUT /environments HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 96
{
  "user": "root",
  "update_files": {
    "http://testbed.lan": "http://www.testbed.lan"
  }
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 830
[
  {
    "name": "debian-custom",
    "version": 1,
    "visibility": "shared",
    "destructive": false,
    "os": "linux",
    "image": {
      "file": "http://www.testbed.lan/debian-base.tgz",
      "kind": "tar",
      "compression": "gzip"
    },
    "boot": {
      "kernel": "/vmlinuz",
      "initrd": "/initrd.img"
    },
    "filesystem": "ext3",
    "partition_type": 0,
    "multipart": false
  },
  {
    "name": "debian-custom",
    "version": 2,
    "visibility": "shared",
    "destructive": false,
    "os": "linux",
    "image": {
      "file": "http://www.testbed.lan/debian-base.tgz",
      "kind": "tar",
      "compression": "gzip"
    },
    "boot": {
      "kernel": "/boot/vmlinuz",
      "initrd": "/boot/initrd.img"
    },
    "filesystem": "ext4",
    "partition_type": 0,
    "multipart": false
  }
]</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Environments management">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="DELETE/environments/:username/:name/:version?"><B class="resource_method_DELETE">DELETE</B> <SPAN style="font-family: monospace;" class="resource_path">/environments/:username/:name/:version?</SPAN></A></H2><P class="resource_desc">Delete a specific environment, returns the resources that was deleted. The :username or the :name fields have to be encoded following the RFC 3986 specifications (non-ASCII characters are encoded with a percent notation)</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">name</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The name of the environment</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">username</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The owner of the environment</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">version</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The version of the environment</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash/Array</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_dynamic"></SPAN></SPAN></TD><TD class="field_type"><A href="#type_Environment">Environment</A></TD><TD class="field_desc">The environment(s) that was deleted</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR><TR class="code_frame"><TD class="code_number">400-12</TD><TD class="code_desc">Nothing modified, no environment was deleted (none were matching the conditions)</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Delete every versions of a specific environment</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">DELETE /environments/frontend/debian-custom HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 830
[
  {
    "name": "debian-custom",
    "version": 1,
    "visibility": "shared",
    "destructive": false,
    "os": "linux",
    "image": {
      "file": "http://www.testbed.lan/debian-base.tgz",
      "kind": "tar",
      "compression": "gzip"
    },
    "boot": {
      "kernel": "/vmlinuz",
      "initrd": "/initrd.img"
    },
    "filesystem": "ext3",
    "partition_type": 0,
    "multipart": false
  },
  {
    "name": "debian-custom",
    "version": 2,
    "visibility": "shared",
    "destructive": false,
    "os": "linux",
    "image": {
      "file": "http://www.testbed.lan/debian-base.tgz",
      "kind": "tar",
      "compression": "gzip"
    },
    "boot": {
      "kernel": "/boot/vmlinuz",
      "initrd": "/boot/initrd.img"
    },
    "filesystem": "ext4",
    "partition_type": 0,
    "multipart": false
  }
]</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #2 <SPAN class="example_desc">Delete a specific version of an environment</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">DELETE /environments/frontend/debian-custom/2 HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 376
{
  "name": "debian-custom",
  "version": 2,
  "visibility": "private",
  "destructive": false,
  "os": "linux",
  "image": {
    "file": "http://testbed.lan/debian-base.tgz",
    "kind": "tar",
    "compression": "gzip"
  },
  "boot": {
    "kernel": "/boot/vmlinuz",
    "initrd": "/boot/initrd.img"
  },
  "filesystem": "ext4",
  "partition_type": 0,
  "multipart": false
}</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Environments management">Back to operation</A></P><HR class="operation_inter_sep"></DIV><HR class="operation_sep"><DIV class="operation_frame"><H1 class="operation_title"><A id="Global information">Global information</A></H1><DIV class="operation_index_frame"><H2 class="operation_index_title">Resources</H2><UL class="operation_index_list"><LI><A class="operation_index_link" href="#GET/clusters"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/clusters</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/auth_headers_prefix"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/auth_headers_prefix</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/info"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/info</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/version"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/version</SPAN></A></LI></UL></DIV><P class="operation_back_link"><A class="operation_back_link" href="#title">Back to title</A></P><HR class="operation_index_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="GET/clusters"><B class="resource_method_GET">GET</B> <SPAN style="font-family: monospace;" class="resource_path">/clusters</SPAN></A></H2><P class="resource_desc">Get the list of clusters</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Array</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_iter">#i</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The name of the cluster #i</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Get the list of clusters</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /clusters HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 45
[
  "griffon-cluster",
  "graphene-cluster"
]</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Global information">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="GET/auth_headers_prefix"><B class="resource_method_GET">GET</B> <SPAN style="font-family: monospace;" class="resource_path">/auth_headers_prefix</SPAN></A></H2><P class="resource_desc">Get information about the authentication HTTP headers of the running service</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">String</SPAN>, <SPAN class="response_content">text/plain</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_dynamic"></SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The prefix that have to be specified in the HTTP headers when doing a request (for authentication purpose)</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR></TABLE></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Global information">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="GET/info"><B class="resource_method_GET">GET</B> <SPAN style="font-family: monospace;" class="resource_path">/info</SPAN></A></H2><P class="resource_desc">Get information about the configuration of the running service</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name">{<SPAN class="element_self"><SPAN class="element_normal">automata</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The configuration of the deployment automata</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">automata</SPAN>}</SPAN>.{<SPAN class="element_self"><SPAN class="element_dynamic">clustername</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The configuration of the deployment automata for the cluster "clustername"</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">automata</SPAN>}</SPAN>.{<SPAN class="element_dynamic">clustername</SPAN>}</SPAN>.[<SPAN class="element_self"><SPAN class="element_dynamic">macrostepkind</SPAN></SPAN>]</TD><TD class="field_type">Array</TD><TD class="field_desc">The configuration of the instances of the step "macrostepkind"</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">automata</SPAN>}</SPAN>.{<SPAN class="element_dynamic">clustername</SPAN>}</SPAN>.[<SPAN class="element_dynamic">macrostepkind</SPAN>]</SPAN>.{<SPAN class="element_self"><SPAN class="element_iter">#i</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The configuration of the instances #i</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">automata</SPAN>}</SPAN>.{<SPAN class="element_dynamic">clustername</SPAN>}</SPAN>.[<SPAN class="element_dynamic">macrostepkind</SPAN>]</SPAN>.{<SPAN class="element_iter">#i</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">name</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The name of the instance</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">automata</SPAN>}</SPAN>.{<SPAN class="element_dynamic">clustername</SPAN>}</SPAN>.[<SPAN class="element_dynamic">macrostepkind</SPAN>]</SPAN>.{<SPAN class="element_iter">#i</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">retries</SPAN></SPAN></TD><TD class="field_type">Integer</TD><TD class="field_desc">The number of retries for the instance</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">automata</SPAN>}</SPAN>.{<SPAN class="element_dynamic">clustername</SPAN>}</SPAN>.[<SPAN class="element_dynamic">macrostepkind</SPAN>]</SPAN>.{<SPAN class="element_iter">#i</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">timeout</SPAN></SPAN></TD><TD class="field_type">Integer</TD><TD class="field_desc">The timeout of the instance</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">pxe</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The netboot method configured on the server</TD></TR><TR class="field_frame"><TD class="field_name">{<SPAN class="element_self"><SPAN class="element_normal">supported_fs</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">The filesystem format supported by the deployment environment of the different clusters</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">supported_fs</SPAN>}</SPAN>.[<SPAN class="element_self"><SPAN class="element_dynamic">clustername</SPAN></SPAN>]</TD><TD class="field_type">Array</TD><TD class="field_desc">The filesystem format supported by the deployment environment of the cluster "clustername"</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">supported_fs</SPAN>}</SPAN>.[<SPAN class="element_dynamic">clustername</SPAN>]</SPAN>.<SPAN class="element_self"><SPAN class="element_iter">#format</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The filesystem format name</TD></TR><TR class="field_frame"><TD class="field_name">[<SPAN class="element_self"><SPAN class="element_normal">vars</SPAN></SPAN>]</TD><TD class="field_type">Array</TD><TD class="field_desc">The environment variables exported by the deployment environment when running custom scripts</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">[<SPAN class="element_normal">vars</SPAN>]</SPAN>.<SPAN class="element_self"><SPAN class="element_iter">#name</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The variable name</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Get information about the service's configuration</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /info HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 1851
{
  "pxe": "PXElinux",
  "automata": {
    "griffon-cluster": {
      "SetDeploymentEnv": [
        {
          "name": "SetDeploymentEnvUntrusted",
          "retries": 1,
          "timeout": 200
        }
      ],
      "BroadcastEnv": [
        {
          "name": "BroadcastEnvKastafior",
          "retries": 1,
          "timeout": 200
        }
      ],
      "BootNewEnv": [
        {
          "name": "BootNewEnvKexec",
          "retries": 0,
          "timeout": 200
        },
        {
          "name": "BootNewEnvHardReboot",
          "retries": 1,
          "timeout": 200
        }
      ]
    },
    "graphene-cluster": {
      "SetDeploymentEnv": [
        {
          "name": "SetDeploymentEnvUntrusted",
          "retries": 1,
          "timeout": 200
        }
      ],
      "BroadcastEnv": [
        {
          "name": "BroadcastEnvKastafior",
          "retries": 1,
          "timeout": 200
        }
      ],
      "BootNewEnv": [
        {
          "name": "BootNewEnvKexec",
          "retries": 0,
          "timeout": 200
        },
        {
          "name": "BootNewEnvHardReboot",
          "retries": 1,
          "timeout": 200
        }
      ]
    }
  },
  "supported_fs": {
    "griffon-cluster": [
      "ext2",
      "ext3",
      "fat"
    ],
    "graphene-cluster": [
      "ext2",
      "ext3",
      "fat"
    ]
  },
  "vars": [
    "KADEPLOY_BLOCK_DEVICE",
    "KADEPLOY_CLUSTER",
    "KADEPLOY_DEPLOY_PART",
    "KADEPLOY_DEPLOY_PART_NUM",
    "KADEPLOY_ENV",
    "KADEPLOY_ENV_HYPERVISOR",
    "KADEPLOY_ENV_HYPERVISOR_PARAMS",
    "KADEPLOY_ENV_INITRD",
    "KADEPLOY_ENV_KERNEL",
    "KADEPLOY_ENV_KERNEL_PARAMS",
    "KADEPLOY_OS_KIND",
    "KADEPLOY_PREPOST_EXTRACTION_DIR",
    "KADEPLOY_PROD_PART_NUM",
    "KADEPLOY_SWAP_PART_NUM",
    "KADEPLOY_TMP_DIR",
    "KADEPLOY_TMP_PART_NUM"
  ]
}</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Global information">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="GET/version"><B class="resource_method_GET">GET</B> <SPAN style="font-family: monospace;" class="resource_path">/version</SPAN></A></H2><P class="resource_desc">Get the version of the server</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">String</SPAN>, <SPAN class="response_content">text/plain</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_dynamic"></SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The version of the server</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Get the version of the server "kadeploy.testbed.lan"</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /version HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: text/plain
Content-Length: 5
3.2.0</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Global information">Back to operation</A></P><HR class="operation_inter_sep"></DIV><HR class="operation_sep"><DIV class="operation_frame"><H1 class="operation_title"><A id="Deployment">Deployment</A></H1><DIV class="operation_index_frame"><H2 class="operation_index_title">Resources</H2><UL class="operation_index_list"><LI><A class="operation_index_link" href="#POST/deployment"><SPAN class="resource_id_method_POST">POST</SPAN> <SPAN class="resource_id_path">/deployment</SPAN></A></LI></UL></DIV><P class="operation_back_link"><A class="operation_back_link" href="#title">Back to title</A></P><HR class="operation_index_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="POST/deployment"><B class="resource_method_POST">POST</B> <SPAN style="font-family: monospace;" class="resource_path">/deployment</SPAN></A></H2><P class="resource_desc">Launch a deployment</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name">{<SPAN class="element_self"><SPAN class="element_normal">environment</SPAN></SPAN>}</TD><TD class="parameter_type">Hash</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The environment that have to be deployed</TD></TR><TR class="parameter_frame"><TD class="parameter_name">[<SPAN class="element_self"><SPAN class="element_normal">nodes</SPAN></SPAN>]</TD><TD class="parameter_type">Array</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The list of nodes the operation should be applied on</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_dynamic">_generic_parameter_</SPAN></SPAN></TD><TD class="parameter_type">...</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Some workflow-based operation's generic parameter (see more <A href="#workflow_operations">here</A>)</TD></TR><TR class="parameter_frame"><TD class="parameter_name">{<SPAN class="element_self"><SPAN class="element_normal">automata</SPAN></SPAN>}</TD><TD class="parameter_type">Hash</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">...</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">block_device</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The block device the environment should be installed on</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">boot_partition</SPAN></SPAN></TD><TD class="parameter_type">Integer</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The partition the node have to boot on (useful when deploying an image of the whole disk</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">client</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The client used to export files to the server, useful for local:// files (see more <A href="#file_export">here</A>)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">deploy_partition</SPAN></SPAN></TD><TD class="parameter_type">Integer</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The partition the environment should be installed on</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">disable_bootloader_install</SPAN></SPAN></TD><TD class="parameter_type">Set</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Disable the install of a bootloader on the partition the image is installed on</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">disable_disk_partitioning</SPAN></SPAN></TD><TD class="parameter_type">Set</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Disable the disk partitioning step</TD></TR><TR class="parameter_frame"><TD class="parameter_name">{<SPAN class="element_self"><SPAN class="element_normal">pxe</SPAN></SPAN>}</TD><TD class="parameter_type">Hash</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Specify some custom netboot parameters</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">reformat_tmp_partition</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Reformat the partition that was defined as the tmp partition with the specified format</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">ssh_authorized_keys</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The path to a ssh authorized_keys file that have to be copied in the root directory of the deployed environment (see more <A href="#file_export">here</A>)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">timeout_reboot_classical</SPAN></SPAN></TD><TD class="parameter_type">Integer</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Overwrite the default value for the reboot timeout</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">timeout_reboot_kexec</SPAN></SPAN></TD><TD class="parameter_type">Integer</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Overwrite the default value for the kexec timeout</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">vlan</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Specify the VLAN the nodes should be reboot in</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">kind</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The kind of environment, recorded or anonymous<BR><EM>Expected values: </EM>anon, database</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">name</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The name of the environment</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_dynamic">fields</SPAN></SPAN></TD><TD class="parameter_type"><A href="#type_Environment">Environment</A></TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Other fields that are used to describe an anonymous environment</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">user</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The owner of the environment</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">environment</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">version</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The version of the environment</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">pxe</SPAN>}</SPAN>.[<SPAN class="element_self"><SPAN class="element_normal">files</SPAN></SPAN>]</TD><TD class="parameter_type">Array</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">A list of path to files that have to be exported in the PXE repository's directory (see more <A href="#file_export">here</A>)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">pxe</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">profile</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">A custom PXE profile, the string FILES_PREFIX-- will be replaced by the prefix to some exported files</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent">{<SPAN class="element_normal">pxe</SPAN>}</SPAN>.{<SPAN class="element_self"><SPAN class="element_normal">singularities</SPAN></SPAN>}</TD><TD class="parameter_type">Hash</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Specify a substitution pattern for each node in the PXE profile (the NODE_SINGULARITY pattern must be used in the PXE profile)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_parent"><SPAN class="element_parent">{<SPAN class="element_normal">pxe</SPAN>}</SPAN>.{<SPAN class="element_normal">singularities</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_dynamic">nodename</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The substitution pattern for the node "nodename"</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_dynamic"></SPAN></SPAN></TD><TD class="field_type"><A href="#type_Workflow">Workflow</A></TD><TD class="field_desc">Information related to the workflow of the deployment</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Deploy a recorded environment using the user specified key file</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">POST /deployment HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 298
{
  "nodes": [
    "node-1.testbed.lan",
    "node-2.testbed.lan"
  ],
  "environment": {
    "kind": "database",
    "user": "root",
    "name": "debian-base",
    "version": 1
  },
  "ssh_authorized_keys": "/home/frontend/.ssh/authorized_keys",
  "client": "http://frontend.testbed.lan:12345"
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 545
{
  "wid": "D-bf5608b0-9354-446b-a648-c3abaa3cab95",
  "resources": {
    "resource": "/deployment/D-bf5608b0-9354-446b-a648-c3abaa3cab95",
    "log": "/deployment/D-bf5608b0-9354-446b-a648-c3abaa3cab95/logs",
    "logs": {
      "griffon-cluster": "/deployment/D-bf5608b0-9354-446b-a648-c3abaa3cab95/logs/griffon-cluster"
    },
    "state": "/deployment/D-bf5608b0-9354-446b-a648-c3abaa3cab95/state",
    "status": "/deployment/D-bf5608b0-9354-446b-a648-c3abaa3cab95/status",
    "error": "/deployment/D-bf5608b0-9354-446b-a648-c3abaa3cab95/error"
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #2 <SPAN class="example_desc">Deploy an anonymous local environment</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">POST /deployment HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 825
{
  "nodes": [
    "node-1.testbed.lan",
    "node-2.testbed.lan"
  ],
  "environment": {
    "kind": "anonymous",
    "name": "debian-anon",
    "version": 1,
    "description": "My custom Debian 7",
    "author": "frontend@testbed.lan",
    "visibility": "shared",
    "destructive": false,
    "os": "linux",
    "image": {
      "file": "/home/frontend/debian-base.tgz",
      "kind": "tar",
      "compression": "gzip"
    },
    "postinstalls": [
      {
        "archive": "/home/frontend/debian-base-postinstall.tgz",
        "compression": "gzip",
        "script": "traitement.ash /rambin"
      }
    ],
    "boot": {
      "kernel": "/vmlinuz",
      "initrd": "/initrd.img"
    },
    "filesystem": "ext3",
    "partition_type": 83,
    "multipart": false
  },
  "client": "http://frontend.testbed.lan:12345"
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 555
{
  "wid": "D-abbaa88c-243e-42fb-8c5a-9332918a6ee1",
  "resources": {
    "resource": "/deployment/D-abbaa88c-243e-42fb-8c5a-9332918a6ee1",
    "log": "/deployment/D-abbaa88c-243e-42fb-8c5a-9332918a6ee1/logs",
    "logs": {
      "griffon-cluster": "/deployment/D-abbaa88c-243e-42fb-8c5a-9332918a6ee1/logs/griffon-cluster"
    },
    "state": "/deployment/D-abbaa88c-243e-42fb-8c5a-9332918a6ee1/state",
    "status": "/deployment/D-abbaa88c-243e-42fb-8c5a-9332918a6ee1/status",
    "error": "/deployment/D-abbaa88c-243e-42fb-8c5a-9332918a6ee1/error"
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #3 <SPAN class="example_desc">Deploy an anonymous HTTP environment</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">POST /deployment HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 784
{
  "nodes": [
    "node-1.testbed.lan",
    "node-2.testbed.lan"
  ],
  "environment": {
    "kind": "anonymous",
    "name": "debian-anon",
    "version": 1,
    "description": "My custom Debian 7",
    "author": "frontend@testbed.lan",
    "visibility": "shared",
    "destructive": false,
    "os": "linux",
    "image": {
      "file": "http://testbed.lan/debian-base.tgz",
      "kind": "tar",
      "compression": "gzip"
    },
    "postinstalls": [
      {
        "archive": "http://testbed.lan/debian-base-postinstall.tgz",
        "compression": "gzip",
        "script": "traitement.ash /rambin"
      }
    ],
    "boot": {
      "kernel": "/vmlinuz",
      "initrd": "/initrd.img"
    },
    "filesystem": "ext3",
    "partition_type": 83,
    "multipart": false
  }
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 545
{
  "wid": "D-2669bedd-82f2-4be6-b090-a0837ad4e0a9",
  "resources": {
    "resource": "/deployment/D-2669bedd-82f2-4be6-b090-a0837ad4e0a9",
    "log": "/deployment/D-2669bedd-82f2-4be6-b090-a0837ad4e0a9/logs",
    "logs": {
      "griffon-cluster": "/deployment/D-2669bedd-82f2-4be6-b090-a0837ad4e0a9/logs/griffon-cluster"
    },
    "state": "/deployment/D-2669bedd-82f2-4be6-b090-a0837ad4e0a9/state",
    "status": "/deployment/D-2669bedd-82f2-4be6-b090-a0837ad4e0a9/status",
    "error": "/deployment/D-2669bedd-82f2-4be6-b090-a0837ad4e0a9/error"
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #4 <SPAN class="example_desc">Deploy a recorded environment and reboot the nodes on a custom kernel with some nodes singularities</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">POST /deployment HTTP/1.1
     Accept: text/plain, application/json
     Host: kadeploy.testbed.lan:25300
     X-Kadeploy-User: frontend
     Content-Type: application/json
     Content-Length: 704
     {
       "nodes": [
         "node-1.testbed.lan",
         "node-2.testbed.lan"
       ],
       "environment": {
         "kind": "database",
         "user": "root",
         "name": "debian-base",
         "version": 1
       },
       "pxe": {
         "profile": "PROMPT 1
SERIAL 0 19200
DEFAULT bootlabel
DISPLAY messages
TIMEOUT 50
label bootlabel
KERNEL FILES_PREFIX--myvmlinuz
APPEND initrd=FILES_PREFIX--myinitrd console=tty0 console=ttyS0,19200n8 ramdisk_size=290000 id=NODE_SINGULARITY rw noapic
",
         "singularities": {
           "node-1.testbed.lan": "1",
           "node-2.testbed.lan": "2"
         },
         "files": [
           "/home/frontend/myvmlinuz",
           "/home/frontend/myinitrd"
         ]
       },
       "client": "http://frontend.testbed.lan:12345"
     }</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 557
{
  "wid": "D-af1a66b0-c18c-4dc3-a4ee-73e6502bc5fc",
  "resources": {
    "resource": "/deployment/D-af1a66b0-c18c-4dc3-a4ee-73e6502bc5fc",
    "log": "/deployment/D-af1a66b0-c18c-4dc3-a4ee-73e6502bc5fc/logs",
    "logs": {
      "graphene-cluster": "/deployment/D-af1a66b0-c18c-4dc3-a4ee-73e6502bc5fc/logs/graphene-cluster"
    },
    "state": "/deployment/D-af1a66b0-c18c-4dc3-a4ee-73e6502bc5fc/state",
    "status": "/deployment/D-af1a66b0-c18c-4dc3-a4ee-73e6502bc5fc/status",
    "error": "/deployment/D-af1a66b0-c18c-4dc3-a4ee-73e6502bc5fc/error"
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #5 <SPAN class="example_desc">Deploy an environment and overwrite the automata's steps</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">POST /deployment HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 648
{
  "nodes": [
    "node-1.testbed.lan",
    "node-2.testbed.lan"
  ],
  "environment": {
    "kind": "database",
    "user": "root",
    "name": "debian-base",
    "version": 1
  },
  "automata": {
    "SetDeploymentEnv": [
      {
        "name": "SetDeploymentEnvUntrusted",
        "retries": 1,
        "timeout": 800
      }
    ],
    "BroadcastEnv": [
      {
        "name": "BroadcastEnvKastafior",
        "retries": 1,
        "timeout": 1200
      }
    ],
    "BootNewEnv": [
      {
        "name": "BootNewEnvKexec",
        "retries": 1,
        "timeout": 400
      }
    ]
  },
  "client": "http://frontend.testbed.lan:12345"
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 557
{
  "wid": "D-facf0b49-20b0-4891-838e-06ee04c8045f",
  "resources": {
    "resource": "/deployment/D-facf0b49-20b0-4891-838e-06ee04c8045f",
    "log": "/deployment/D-facf0b49-20b0-4891-838e-06ee04c8045f/logs",
    "logs": {
      "graphene-cluster": "/deployment/D-facf0b49-20b0-4891-838e-06ee04c8045f/logs/graphene-cluster"
    },
    "state": "/deployment/D-facf0b49-20b0-4891-838e-06ee04c8045f/state",
    "status": "/deployment/D-facf0b49-20b0-4891-838e-06ee04c8045f/status",
    "error": "/deployment/D-facf0b49-20b0-4891-838e-06ee04c8045f/error"
  }
}</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Deployment">Back to operation</A></P><HR class="operation_inter_sep"></DIV><HR class="operation_sep"><DIV class="operation_frame"><H1 class="operation_title"><A id="Console">Console</A></H1><DIV class="operation_index_frame"><H2 class="operation_index_title">Resources</H2><UL class="operation_index_list"><LI><A class="operation_index_link" href="#POST/console"><SPAN class="resource_id_method_POST">POST</SPAN> <SPAN class="resource_id_path">/console</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/console"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/console</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/console/:id"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/console/:id</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/console/:id/error"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/console/:id/error</SPAN></A></LI><LI><A class="operation_index_link" href="#DELETE/console/:id"><SPAN class="resource_id_method_DELETE">DELETE</SPAN> <SPAN class="resource_id_path">/console/:id</SPAN></A></LI></UL></DIV><P class="operation_back_link"><A class="operation_back_link" href="#title">Back to title</A></P><HR class="operation_index_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="POST/console"><B class="resource_method_POST">POST</B> <SPAN style="font-family: monospace;" class="resource_path">/console</SPAN></A></H2><P class="resource_desc">Create a console binding. The server will create a TCP channel to bind the console inputs/outputs.<BR> To create an interactive shell, you can use a command such as:<BR><TT>stty raw -echo; nc <I>HOST</I> <I>PORT</I>; stty -raw echo</TT></P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">node</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The node to establish the console to</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">id</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The id# of the operation (prefixed by "C-")</TD></TR><TR class="field_frame"><TD class="field_name">{<SPAN class="element_self"><SPAN class="element_normal">resources</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">Resources related to the workflow</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">resources</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">console</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">URI to the TCP channel used to bind the console inputs/outputs</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">resources</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">error</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">URI to the error</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_normal">resources</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">resource</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">URI to the resource</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Require a console connection on node-1. You can then </SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">POST /console?node=node-1.testbed.lan HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 262
{
  "wid": "C-a6efa265-56f7-4221-b41c-81f75bde4699",
  "resources": {
    "resource": "/console/C-a6efa265-56f7-4221-b41c-81f75bde4699",
    "error": "/console/C-a6efa265-56f7-4221-b41c-81f75bde4699/error",
    "console": "tcp://kadeploy.testbed.lan:36179"
  }
}</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Console">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="GET/console"><B class="resource_method_GET">GET</B> <SPAN style="font-family: monospace;" class="resource_path">/console</SPAN></A></H2><P class="resource_desc">Get the workflow information of every running operation of the kind console</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name">{<SPAN class="element_self"><SPAN class="element_iter">#i</SPAN></SPAN>}</TD><TD class="field_type">Hash</TD><TD class="field_desc">Information about the workflow #i</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_iter">#i</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">attached</SPAN></SPAN></TD><TD class="field_type">Boolean</TD><TD class="field_desc">Set to true if the TCP channel is in use. Only available to the users that have the rights to consult the information about this operation.</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_iter">#i</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">console_uri</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">URI to the TCP channel used to bind the console inputs/outputs. Only available to the users that have the rights to consult the information about this operation.</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_iter">#i</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">error</SPAN></SPAN></TD><TD class="field_type">Boolean</TD><TD class="field_desc">Set to true if an error was encountered. The error message can be obtained by getting /console/:id/error. Only available to the users that have the rights to consult the information about this operation.</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_iter">#i</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">id</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The id# of the operation (prefixed by "C-")</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_iter">#i</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">node</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The node the console is open to</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_iter">#i</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">time</SPAN></SPAN></TD><TD class="field_type">Float</TD><TD class="field_desc">The time elapsed since the start of the operation.</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_parent">{<SPAN class="element_iter">#i</SPAN>}</SPAN>.<SPAN class="element_self"><SPAN class="element_normal">user</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The user that initiated the operation</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Get the list of consoles</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /console HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 371
[
  {
    "id": "C-ef80f906-da3f-4c24-acb7-f6ecd3a7e805",
    "user": "frontend",
    "node": "node-1.testbed.lan",
    "error": false,
    "attached": false,
    "console_uri": "tcp://kadeploy.testbed.lan:49768",
    "time": 27.85
  },
  {
    "id": "C-05d949ea-f213-4285-8efc-0c1a407df757",
    "user": "root",
    "node": "node-2.testbed.lan",
    "error": false
  }
]</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Console">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="GET/console/:id"><B class="resource_method_GET">GET</B> <SPAN style="font-family: monospace;" class="resource_path">/console/:id</SPAN></A></H2><P class="resource_desc">Get the workflow information of an operation</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">id</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The id# of the operation</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">attached</SPAN></SPAN></TD><TD class="field_type">Boolean</TD><TD class="field_desc">Set to true if the TCP channel is in use. Only available to the users that have the rights to consult the information about this operation.</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">console_uri</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">URI to the TCP channel used to bind the console inputs/outputs. Only available to the users that have the rights to consult the information about this operation.</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">error</SPAN></SPAN></TD><TD class="field_type">Boolean</TD><TD class="field_desc">Set to true if an error was encountered. The error message can be obtained by getting /console/:id/error. Only available to the users that have the rights to consult the information about this operation.</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">id</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The id# of the operation (prefixed by "C-")</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">node</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The node the console is open to</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">time</SPAN></SPAN></TD><TD class="field_type">Float</TD><TD class="field_desc">The time elapsed since the start of the operation.</TD></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">user</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The user that initiated the operation</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Get information about a console</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /console/C-ef80f906-da3f-4c24-acb7-f6ecd3a7e805 HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 216
{
  "id": "C-ef80f906-da3f-4c24-acb7-f6ecd3a7e805",
  "user": "frontend",
  "node": "node-1.testbed.lan",
  "error": false,
  "attached": false,
  "console_uri": "tcp://kadeploy.testbed.lan:49768",
  "time": 146.69
}</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Console">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="GET/console/:id/error"><B class="resource_method_GET">GET</B> <SPAN style="font-family: monospace;" class="resource_path">/console/:id/error</SPAN></A></H2><P class="resource_desc">Get the error of an operation (the "error" field was set to true on the workflow's info)</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">id</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The id# of the operation</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">String</SPAN>, <SPAN class="response_content">text/plain</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_dynamic"></SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The error message</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR><TR class="code_frame"><TD class="code_number">404</TD><TD class="code_desc">File not found, the workflow :id cannot be found</TD></TR></TABLE></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Console">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="DELETE/console/:id"><B class="resource_method_DELETE">DELETE</B> <SPAN style="font-family: monospace;" class="resource_path">/console/:id</SPAN></A></H2><P class="resource_desc">Destroy a console binding (the TCP channel will be closed).</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_param">id</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The id# of the operation</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_normal">id</SPAN></SPAN></TD><TD class="field_type">String</TD><TD class="field_desc">The id# of the operation (prefixed by "C-")</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Destroy a console binding</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">DELETE /console/C-ef80f906-da3f-4c24-acb7-f6ecd3a7e805 HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 53
{
  "wid": "C-ef80f906-da3f-4c24-acb7-f6ecd3a7e805"
}</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Console">Back to operation</A></P><HR class="operation_inter_sep"></DIV><HR class="operation_sep"><DIV class="operation_frame"><H1 class="operation_title"><A id="Power operations">Power operations</A></H1><DIV class="operation_index_frame"><H2 class="operation_index_title">Resources</H2><UL class="operation_index_list"><LI><A class="operation_index_link" href="#PUT/power"><SPAN class="resource_id_method_PUT">PUT</SPAN> <SPAN class="resource_id_path">/power</SPAN></A></LI><LI><A class="operation_index_link" href="#GET/power"><SPAN class="resource_id_method_GET">GET</SPAN> <SPAN class="resource_id_path">/power</SPAN></A></LI></UL></DIV><P class="operation_back_link"><A class="operation_back_link" href="#title">Back to title</A></P><HR class="operation_index_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="PUT/power"><B class="resource_method_PUT">PUT</B> <SPAN style="font-family: monospace;" class="resource_path">/power</SPAN></A></H2><P class="resource_desc">Launch a power operation</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name">[<SPAN class="element_self"><SPAN class="element_normal">nodes</SPAN></SPAN>]</TD><TD class="parameter_type">Array</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The list of nodes the operation should be applied on</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">status</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The status to be applied<BR><EM>Expected values: </EM>on, off</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_dynamic">_generic_parameter_</SPAN></SPAN></TD><TD class="parameter_type">...</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">Some workflow-based operation's generic parameter (see more <A href="#workflow_operations">here</A>)</TD></TR><TR class="parameter_frame"><TD class="parameter_name"><SPAN class="element_self"><SPAN class="element_normal">level</SPAN></SPAN></TD><TD class="parameter_type">String</TD><TD class="parameter_mandat">Optional</TD><TD class="parameter_desc">The level of the command that will be performed<BR><EM>Expected values: </EM>soft, hard, very_hard<BR><EM>Default value: </EM>soft</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_dynamic"></SPAN></SPAN></TD><TD class="field_type"><A href="#type_Workflow">Workflow</A></TD><TD class="field_desc">Information related to the workflow of the power operation</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Perform a power-on on some nodes</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">PUT /power HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 91
{
  "nodes": [
    "node-1.testbed.lan",
    "node-2.testbed.lan"
  ],
  "status": "on"
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 527
{
  "wid": "P-eae4fb69-c130-40a6-8c2a-f0a45fa8d6e8",
  "resources": {
    "resource": "/power/P-eae4fb69-c130-40a6-8c2a-f0a45fa8d6e8",
    "log": "/power/P-eae4fb69-c130-40a6-8c2a-f0a45fa8d6e8/logs",
    "logs": {
      "graphene-cluster": "/power/P-eae4fb69-c130-40a6-8c2a-f0a45fa8d6e8/logs/graphene-cluster"
    },
    "state": "/power/P-eae4fb69-c130-40a6-8c2a-f0a45fa8d6e8/state",
    "status": "/power/P-eae4fb69-c130-40a6-8c2a-f0a45fa8d6e8/status",
    "error": "/power/P-eae4fb69-c130-40a6-8c2a-f0a45fa8d6e8/error"
  }
}</PRE></DIV></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #2 <SPAN class="example_desc">Perform a hard power-off on some nodes</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">PUT /power HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend
Content-Type: application/json
Content-Length: 111
{
  "nodes": [
    "node-1.testbed.lan",
    "node-2.testbed.lan"
  ],
  "status": "off",
  "level": "hard"
}</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 527
{
  "wid": "P-2dbf2f2d-6e15-4e8a-8cb7-57ac4bb86a9b",
  "resources": {
    "resource": "/power/P-2dbf2f2d-6e15-4e8a-8cb7-57ac4bb86a9b",
    "log": "/power/P-2dbf2f2d-6e15-4e8a-8cb7-57ac4bb86a9b/logs",
    "logs": {
      "graphene-cluster": "/power/P-2dbf2f2d-6e15-4e8a-8cb7-57ac4bb86a9b/logs/graphene-cluster"
    },
    "state": "/power/P-2dbf2f2d-6e15-4e8a-8cb7-57ac4bb86a9b/state",
    "status": "/power/P-2dbf2f2d-6e15-4e8a-8cb7-57ac4bb86a9b/status",
    "error": "/power/P-2dbf2f2d-6e15-4e8a-8cb7-57ac4bb86a9b/error"
  }
}</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Power operations">Back to operation</A></P><HR class="operation_inter_sep"><DIV class="resource_frame"><H2 class="resource_title"><A id="GET/power"><B class="resource_method_GET">GET</B> <SPAN style="font-family: monospace;" class="resource_path">/power</SPAN></A></H2><P class="resource_desc">Get the power status of some nodes</P><DIV class="request_frame"><H3 class="request_title">Request <SPAN class="request_title_desc">(<SPAN class="request_type">Hash</SPAN>, <SPAN class="request_content">application/json</SPAN>)</SPAN></H3><DIV class="request_subframe"><H4 class="request_subtitle">Parameters</H4><TABLE class="request_parameters"><TR><TH>Name</TH><TH>Type</TH><TH>Kind</TH><TH>Description</TH></TR><TR class="parameter_frame"><TD class="parameter_name">[<SPAN class="element_self"><SPAN class="element_normal">nodes</SPAN></SPAN>]</TD><TD class="parameter_type">Array</TD><TD class="parameter_mandat">Mandatory</TD><TD class="parameter_desc">The list of nodes the power status should be returned</TD></TR></TABLE></DIV></DIV><DIV class="response_frame"><H3 class="response_title">Response <SPAN class="response_title_desc">(<SPAN class="response_type">Hash</SPAN>, <SPAN class="response_content">application/json</SPAN>)</SPAN></H3><DIV class="response_subframe"><H4 class="response_subtitle">Fields</H4><TABLE class="response_fields"><TR><TH>Name</TH><TH>Type</TH><TH>Description</TH></TR><TR class="field_frame"><TD class="field_name"><SPAN class="element_self"><SPAN class="element_dynamic"></SPAN></SPAN></TD><TD class="field_type"><A href="#type_Workflow">Workflow</A></TD><TD class="field_desc">Information related to the workflow of the power operation</TD></TR></TABLE><H4 class="response_subtitle">Return codes</H4><TABLE class="response_codes"><TR><TH>Code#</TH><TH>Description</TH></TR><TR class="code_frame"><TD class="code_number">200</TD><TD class="code_desc">OK, the request is successful</TD></TR><TR class="code_frame"><TD class="code_number">500</TD><TD class="code_desc">Internal Server Error, an uncatched exception was thrown on the server</TD></TR><TR class="code_frame"><TD class="code_number">400</TD><TD class="code_desc">Bad Request, Kadeploy Error: please check the X-Application-Error-Code and X-Application-Error-Code headers</TD></TR><TR class="code_frame"><TD class="code_number">401</TD><TD class="code_desc">Unauthorized, you need to be authenticated</TD></TR><TR class="code_frame"><TD class="code_number">403</TD><TD class="code_desc">Forbidden, you do not the rights to perform this operation. Unlike a 401 Unauthorized response, authenticating will make no difference.</TD></TR><TR class="code_frame"><TD class="code_number">415</TD><TD class="code_desc">Unsupported Media Type, check the Content-Type of your request's body</TD></TR></TABLE></DIV></DIV><DIV class="example_frame"><H3 class="example_title">Example #1 <SPAN class="example_desc">Get the power-status of some nodes</SPAN></H3><DIV onclick="this.lastChild.style.display = (this.lastChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);this.firstChild.style.display = (this.firstChild.style.display == &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;);" class="example_subframe"><P class="toggle_link">show</P><DIV class="toggle_content" style="display: none;"><H4 class="example_subtitle">Request</H4><PRE class="code_sample">GET /power?nodes=node-1.testbed.lan&nodes=node-2.testbed.lan HTTP/1.1
Accept: text/plain, application/json
Host: kadeploy.testbed.lan:25300
X-Kadeploy-User: frontend</PRE><H4 class="example_subtitle">Response</H4><PRE class="code_sample">HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 527
{
  "wid": "P-1c609d50-b304-4c46-bcd9-ebda4eb9d369",
  "resources": {
    "resource": "/power/P-1c609d50-b304-4c46-bcd9-ebda4eb9d369",
    "log": "/power/P-1c609d50-b304-4c46-bcd9-ebda4eb9d369/logs",
    "logs": {
      "graphene-cluster": "/power/P-1c609d50-b304-4c46-bcd9-ebda4eb9d369/logs/graphene-cluster"
    },
    "state": "/power/P-1c609d50-b304-4c46-bcd9-ebda4eb9d369/state",
    "status": "/power/P-1c609d50-b304-4c46-bcd9-ebda4eb9d369/status",
    "error": "/power/P-1c609d50-b304-4c46-bcd9-ebda4eb9d369/error"
  }
}</PRE></DIV></DIV></DIV></DIV><P class="operation_back_link"><A class="operation_back_link" href="#Power operations">Back to operation</A></P><HR class="operation_inter_sep"></DIV><HR class="operation_sep"></DIV></BODY></HTML>
